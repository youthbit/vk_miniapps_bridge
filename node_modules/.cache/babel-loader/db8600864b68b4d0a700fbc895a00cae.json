{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"children\", \"activeView\", \"onTransition\", \"nav\", \"className\"];\nimport * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { Platform } from '../../lib/platform';\nimport { useConfigProvider } from '../ConfigProvider/ConfigProviderContext';\nimport { SplitColContext } from '../SplitCol/SplitCol';\nimport { ScrollContext } from '../AppRoot/ScrollContext';\nimport { NavTransitionProvider } from '../NavTransitionContext/NavTransitionContext';\nimport { getNavId } from '../../lib/getNavId';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { useDOM } from '../../lib/dom';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { usePlatform } from '../../hooks/usePlatform';\nvar warn = warnOnce('Root');\n/**\n * @see https://vkcom.github.io/VKUI/#/Root\n */\n\nexport var Root = function Root(_ref) {\n  var children = _ref.children,\n      _activeView = _ref.activeView,\n      onTransition = _ref.onTransition,\n      nav = _ref.nav,\n      className = _ref.className,\n      restProps = _objectWithoutProperties(_ref, _excluded);\n\n  var scroll = React.useContext(ScrollContext);\n  var platform = usePlatform();\n\n  var _useDOM = useDOM(),\n      document = _useDOM.document;\n\n  var scrolls = React.useRef({}).current;\n  var viewNodes = React.useRef({}).current;\n\n  var _useConfigProvider = useConfigProvider(),\n      _useConfigProvider$tr = _useConfigProvider.transitionMotionEnabled,\n      transitionMotionEnabled = _useConfigProvider$tr === void 0 ? true : _useConfigProvider$tr;\n\n  var _React$useContext = React.useContext(SplitColContext),\n      animate = _React$useContext.animate;\n\n  var disableAnimation = !transitionMotionEnabled || !animate;\n  var views = React.Children.toArray(children);\n\n  var _React$useState = React.useState({\n    activeView: _activeView,\n    transition: false\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      _React$useState2$ = _React$useState2[0],\n      prevView = _React$useState2$.prevView,\n      activeView = _React$useState2$.activeView,\n      transition = _React$useState2$.transition,\n      isBack = _React$useState2$.isBack,\n      _setState = _React$useState2[1];\n\n  var transitionTo = function transitionTo(panel) {\n    if (panel !== activeView) {\n      var viewIds = views.map(function (view) {\n        return getNavId(view.props, warn);\n      });\n\n      var _isBack = viewIds.indexOf(panel) < viewIds.indexOf(activeView);\n\n      scrolls[activeView] = scroll.getScroll().y;\n\n      _setState({\n        activeView: panel,\n        prevView: activeView,\n        transition: !disableAnimation,\n        isBack: _isBack\n      });\n    }\n  };\n\n  var finishTransition = React.useCallback(function () {\n    return _setState({\n      activeView: activeView,\n      prevView: prevView,\n      isBack: isBack,\n      transition: false\n    });\n  }, [activeView, isBack, prevView]);\n  useIsomorphicLayoutEffect(function () {\n    document.activeElement.blur();\n  }, [activeView]); // Нужен переход\n\n  useIsomorphicLayoutEffect(function () {\n    return transitionTo(_activeView);\n  }, [_activeView]);\n  useIsomorphicLayoutEffect(function () {\n    if (!transition && prevView) {\n      // Закончился переход\n      scroll.scrollTo(0, isBack ? scrolls[activeView] : 0);\n      onTransition && onTransition({\n        isBack: Boolean(isBack),\n        from: prevView,\n        to: activeView\n      });\n    }\n  }, [transition, prevView]);\n  var fallbackTransition = useTimeout(finishTransition, platform === Platform.IOS ? 600 : 300);\n  React.useEffect(function () {\n    if (!transition) {\n      fallbackTransition.clear();\n      return;\n    }\n\n    fallbackTransition.set();\n  }, [fallbackTransition, transition]);\n\n  var onAnimationEnd = function onAnimationEnd(e) {\n    if (['vkui-root-android-animation-hide-back', 'vkui-root-android-animation-show-forward', 'vkui-root-ios-animation-hide-back', 'vkui-root-ios-animation-show-forward'].includes(e.animationName)) {\n      finishTransition();\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({}, restProps, {\n    className: classNames(\"vkuiRoot\", platform === Platform.IOS && \"vkuiRoot--ios\", transition && \"vkuiRoot--transition\", className)\n  }), views.map(function (view) {\n    var _scrolls$viewId;\n\n    var viewId = getNavId(view.props, warn);\n\n    if (viewId !== activeView && !(transition && viewId === prevView)) {\n      return null;\n    }\n\n    var isTransitionTarget = transition && viewId === (isBack ? prevView : activeView);\n    var compensateScroll = transition && (viewId === prevView || isBack && viewId === activeView);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: viewId,\n      ref: function ref(e) {\n        return viewId && (viewNodes[viewId] = e);\n      },\n      onAnimationEnd: isTransitionTarget ? onAnimationEnd : undefined,\n      className: classNames(\"vkuiRoot__view\", transition && viewId === prevView && isBack && \"vkuiRoot__view--hide-back\", transition && viewId === prevView && !isBack && \"vkuiRoot__view--hide-forward\", transition && viewId === activeView && isBack && \"vkuiRoot__view--show-back\", transition && viewId === activeView && !isBack && \"vkuiRoot__view--show-forward\")\n    }, /*#__PURE__*/React.createElement(NavTransitionProvider, {\n      entering: transition && viewId === activeView\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"vkuiRoot__scrollCompensation\",\n      style: {\n        marginTop: compensateScroll ? viewId && -((_scrolls$viewId = scrolls[viewId]) !== null && _scrolls$viewId !== void 0 ? _scrolls$viewId : 0) : undefined\n      }\n    }, view)));\n  }));\n};","map":{"version":3,"mappings":"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","names":["React","classNames","Platform","useConfigProvider","SplitColContext","ScrollContext","NavTransitionProvider","getNavId","warnOnce","useDOM","useIsomorphicLayoutEffect","useTimeout","usePlatform","warn","Root","_ref","children","_activeView","activeView","onTransition","nav","className","restProps","scroll","useContext","platform","document","scrolls","useRef","current","viewNodes","_useConfigProvider$tr","transitionMotionEnabled","animate","disableAnimation","views","Children","toArray","useState","transition","_React$useState2","_React$useState2$","prevView","isBack","_setState","transitionTo","panel","viewIds","map","view","props","indexOf","getScroll","y","finishTransition","useCallback","activeElement","blur","scrollTo","Boolean","from","to","fallbackTransition","IOS","useEffect","clear","set","onAnimationEnd","e","includes","animationName","viewId","isTransitionTarget","compensateScroll","key","ref","undefined","entering","style","marginTop","_scrolls$viewId"],"sources":["/Users/pitus_anonimous/Desktop/youth_bit_hack/youth_bit_vk/node_modules/@vkontakte/vkui/src/components/Root/Root.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { Platform } from '../../lib/platform';\nimport { useConfigProvider } from '../ConfigProvider/ConfigProviderContext';\nimport { SplitColContext } from '../SplitCol/SplitCol';\nimport { ScrollContext } from '../AppRoot/ScrollContext';\nimport { NavTransitionProvider } from '../NavTransitionContext/NavTransitionContext';\nimport { getNavId, NavIdProps } from '../../lib/getNavId';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { useDOM } from '../../lib/dom';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport styles from './Root.module.css';\n\nexport interface RootProps extends React.HTMLAttributes<HTMLDivElement>, NavIdProps {\n  activeView: string;\n  onTransition?(params: { isBack: boolean; from: string; to: string }): void;\n}\n\nexport interface RootState {\n  activeView: string;\n  transition: boolean;\n  isBack?: boolean;\n  prevView?: string;\n}\n\nconst warn = warnOnce('Root');\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Root\n */\nexport const Root = ({\n  children,\n  activeView: _activeView,\n  onTransition,\n  nav,\n  className,\n  ...restProps\n}: RootProps) => {\n  const scroll = React.useContext(ScrollContext);\n  const platform = usePlatform();\n  const { document } = useDOM();\n  const scrolls = React.useRef<Record<string, number>>({}).current;\n  const viewNodes = React.useRef<Record<string, HTMLElement | null>>({}).current;\n\n  const { transitionMotionEnabled = true } = useConfigProvider();\n  const { animate } = React.useContext(SplitColContext);\n  const disableAnimation = !transitionMotionEnabled || !animate;\n\n  const views = React.Children.toArray(children) as React.ReactElement[];\n\n  const [{ prevView, activeView, transition, isBack }, _setState] = React.useState<RootState>({\n    activeView: _activeView,\n    transition: false,\n  });\n  const transitionTo = (panel: string) => {\n    if (panel !== activeView) {\n      const viewIds = views.map((view) => getNavId(view.props, warn));\n      const isBack = viewIds.indexOf(panel) < viewIds.indexOf(activeView);\n      scrolls[activeView] = scroll.getScroll().y;\n      _setState({\n        activeView: panel,\n        prevView: activeView,\n        transition: !disableAnimation,\n        isBack,\n      });\n    }\n  };\n  const finishTransition = React.useCallback(\n    () => _setState({ activeView, prevView, isBack, transition: false }),\n    [activeView, isBack, prevView],\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    (document!.activeElement as HTMLElement).blur();\n  }, [activeView]);\n\n  // Нужен переход\n  useIsomorphicLayoutEffect(() => transitionTo(_activeView), [_activeView]);\n  useIsomorphicLayoutEffect(() => {\n    if (!transition && prevView) {\n      // Закончился переход\n      scroll.scrollTo(0, isBack ? scrolls[activeView] : 0);\n      onTransition &&\n        onTransition({\n          isBack: Boolean(isBack),\n          from: prevView,\n          to: activeView,\n        });\n    }\n  }, [transition, prevView]);\n\n  const fallbackTransition = useTimeout(finishTransition, platform === Platform.IOS ? 600 : 300);\n  React.useEffect(() => {\n    if (!transition) {\n      fallbackTransition.clear();\n      return;\n    }\n    fallbackTransition.set();\n  }, [fallbackTransition, transition]);\n\n  const onAnimationEnd = (e: React.AnimationEvent) => {\n    if (\n      [\n        'vkui-root-android-animation-hide-back',\n        'vkui-root-android-animation-show-forward',\n        'vkui-root-ios-animation-hide-back',\n        'vkui-root-ios-animation-show-forward',\n      ].includes(e.animationName)\n    ) {\n      finishTransition();\n    }\n  };\n\n  return (\n    <div\n      {...restProps}\n      className={classNames(\n        styles['Root'],\n        platform === Platform.IOS && styles['Root--ios'],\n        transition && styles['Root--transition'],\n        className,\n      )}\n    >\n      {views.map((view) => {\n        const viewId = getNavId(view.props, warn);\n        if (viewId !== activeView && !(transition && viewId === prevView)) {\n          return null;\n        }\n        const isTransitionTarget = transition && viewId === (isBack ? prevView : activeView);\n        const compensateScroll =\n          transition && (viewId === prevView || (isBack && viewId === activeView));\n        return (\n          <div\n            key={viewId}\n            ref={(e) => viewId && (viewNodes[viewId] = e)}\n            onAnimationEnd={isTransitionTarget ? onAnimationEnd : undefined}\n            className={classNames(\n              styles['Root__view'],\n              transition && viewId === prevView && isBack && styles['Root__view--hide-back'],\n              transition && viewId === prevView && !isBack && styles['Root__view--hide-forward'],\n              transition && viewId === activeView && isBack && styles['Root__view--show-back'],\n              transition && viewId === activeView && !isBack && styles['Root__view--show-forward'],\n            )}\n          >\n            <NavTransitionProvider entering={transition && viewId === activeView}>\n              <div\n                className={styles['Root__scrollCompensation']}\n                style={{\n                  marginTop: compensateScroll ? viewId && -(scrolls[viewId] ?? 0) : undefined,\n                }}\n              >\n                {view}\n              </div>\n            </NavTransitionProvider>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}