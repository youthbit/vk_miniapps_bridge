{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _excluded = [\"children\", \"Component\", \"onClick\", \"onKeyDown\", \"activeEffectDelay\", \"stopPropagation\", \"getRootRef\", \"hasHover\", \"hoverMode\", \"hasActive\", \"activeMode\", \"focusVisibleMode\", \"onEnter\", \"onLeave\", \"className\"];\nimport * as React from 'react';\nimport mitt from 'mitt';\nimport { classNames, noop } from '@vkontakte/vkjs';\nimport { Touch } from '../Touch/Touch';\nimport TouchRootContext from '../Touch/TouchContext';\nimport { Platform } from '../../lib/platform';\nimport { getOffsetRect } from '../../lib/offset';\nimport { coordX, coordY } from '../../lib/touch';\nimport { shouldTriggerClickOnEnterOrSpace } from '../../lib/accessibility';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { FocusVisible } from '../FocusVisible/FocusVisible';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useFocusVisible } from '../../hooks/useFocusVisible';\nimport { callMultiple } from '../../lib/callMultiple';\nimport { useBooleanState } from '../../hooks/useBooleanState';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useAdaptivityHasHover } from '../../hooks/useAdaptivityHasHover';\nimport { useAdaptivityHasPointer } from '../../hooks/useAdaptivityHasPointer';\nvar sizeXClassNames = {\n  none: \"vkuiTappable--sizeX-none\",\n  compact: \"vkuiTappable--sizeX-compact\",\n  regular: \"vkuiTappable--sizeX-regular\"\n};\nvar WAVE_LIVE = 225;\nexport var ACTIVE_DELAY = 70;\nexport var ACTIVE_EFFECT_DELAY = 600;\nvar activeBus = mitt();\nvar TapState = {\n  none: 0,\n  pending: 1,\n  active: 2,\n  exiting: 3\n};\nvar TappableContext = /*#__PURE__*/React.createContext({\n  onHoverChange: noop\n});\n\nfunction isPresetStateMode(stateMode) {\n  switch (stateMode) {\n    case 'opacity':\n    case 'background':\n      return true;\n\n    default:\n      return false;\n  }\n}\n\nfunction useActivity(hasActive, stopDelay) {\n  var id = React.useMemo(function () {\n    return Math.round(Math.random() * 1e8).toString(16);\n  }, []);\n\n  var _React$useState = React.useState(TapState.none),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activity = _React$useState2[0],\n      setActivity = _React$useState2[1];\n\n  var _stop = function _stop() {\n    return setActivity(TapState.none);\n  };\n\n  var start = function start() {\n    return hasActive && setActivity(TapState.active);\n  };\n\n  var delayStart = function delayStart() {\n    hasActive && setActivity(TapState.pending);\n  };\n\n  var activeTimeout = useTimeout(start, ACTIVE_DELAY);\n  var stopTimeout = useTimeout(_stop, stopDelay);\n  useIsomorphicLayoutEffect(function () {\n    if (activity === TapState.pending) {\n      activeTimeout.set();\n      return activeTimeout.clear;\n    }\n\n    if (activity === TapState.exiting) {\n      return stopTimeout.clear;\n    }\n\n    if (activity === TapState.active) {\n      activeBus.emit('active', id);\n    }\n\n    return noop;\n  }, [activity]);\n  useIsomorphicLayoutEffect(function () {\n    if (activity === TapState.none) {\n      return noop;\n    }\n\n    var onActiveChange = function onActiveChange(activeId) {\n      activeId !== id && _stop();\n    };\n\n    activeBus.on('active', onActiveChange);\n    return function () {\n      return activeBus.off('active', onActiveChange);\n    };\n  }, [activity === TapState.none]);\n  useIsomorphicLayoutEffect(function () {\n    !hasActive && _stop();\n  }, [hasActive]);\n\n  var stop = function stop(delay) {\n    if (delay) {\n      setActivity(TapState.exiting);\n      return stopTimeout.set(delay);\n    }\n\n    _stop();\n  };\n\n  return [activity, {\n    delayStart: delayStart,\n    start: start,\n    stop: stop\n  }];\n}\n/**\n * @see https://vkcom.github.io/VKUI/#/Tappable\n */\n\n\nexport var Tappable = function Tappable(_ref) {\n  var children = _ref.children,\n      Component = _ref.Component,\n      onClick = _ref.onClick,\n      _onKeyDown = _ref.onKeyDown,\n      _ref$activeEffectDela = _ref.activeEffectDelay,\n      activeEffectDelay = _ref$activeEffectDela === void 0 ? ACTIVE_EFFECT_DELAY : _ref$activeEffectDela,\n      _ref$stopPropagation = _ref.stopPropagation,\n      stopPropagation = _ref$stopPropagation === void 0 ? false : _ref$stopPropagation,\n      getRootRef = _ref.getRootRef,\n      _ref$hasHover = _ref.hasHover,\n      _hasHover = _ref$hasHover === void 0 ? true : _ref$hasHover,\n      _ref$hoverMode = _ref.hoverMode,\n      hoverMode = _ref$hoverMode === void 0 ? 'background' : _ref$hoverMode,\n      _ref$hasActive = _ref.hasActive,\n      _hasActive = _ref$hasActive === void 0 ? true : _ref$hasActive,\n      _ref$activeMode = _ref.activeMode,\n      activeMode = _ref$activeMode === void 0 ? 'background' : _ref$activeMode,\n      _ref$focusVisibleMode = _ref.focusVisibleMode,\n      focusVisibleMode = _ref$focusVisibleMode === void 0 ? 'inside' : _ref$focusVisibleMode,\n      onEnter = _ref.onEnter,\n      onLeave = _ref.onLeave,\n      className = _ref.className,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  Component = Component || (props.href ? 'a' : 'div');\n\n  var _React$useContext = React.useContext(TappableContext),\n      onHoverChange = _React$useContext.onHoverChange;\n\n  var insideTouchRoot = React.useContext(TouchRootContext);\n  var platform = usePlatform();\n\n  var _useFocusVisible = useFocusVisible(),\n      focusVisible = _useFocusVisible.focusVisible,\n      onBlur = _useFocusVisible.onBlur,\n      onFocus = _useFocusVisible.onFocus;\n\n  var _useAdaptivity = useAdaptivity(),\n      _useAdaptivity$sizeX = _useAdaptivity.sizeX,\n      sizeX = _useAdaptivity$sizeX === void 0 ? 'none' : _useAdaptivity$sizeX;\n\n  var hasPointerContext = useAdaptivityHasPointer();\n  var hasHoverContext = useAdaptivityHasHover();\n\n  var _React$useState3 = React.useState([]),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      clicks = _React$useState4[0],\n      setClicks = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      childHover = _React$useState6[0],\n      setChildHover = _React$useState6[1];\n\n  var _useBooleanState = useBooleanState(false),\n      _hovered = _useBooleanState.value,\n      setHoveredTrue = _useBooleanState.setTrue,\n      setHoveredFalse = _useBooleanState.setFalse;\n\n  var hovered = _hovered && !props.disabled;\n  var hasActive = _hasActive && !childHover && !props.disabled;\n  var hasHover = hasHoverContext && _hasHover && !childHover;\n  var isCustomElement = Component !== 'a' && Component !== 'button' && Component !== 'label' && !props.contentEditable;\n  var isPresetHoverMode = isPresetStateMode(hoverMode);\n  var isPresetActiveMode = isPresetStateMode(activeMode);\n  var isPresetFocusVisibleMode = ['inside', 'outside'].includes(focusVisibleMode);\n\n  var _useActivity = useActivity(hasActive, activeEffectDelay),\n      _useActivity2 = _slicedToArray(_useActivity, 2),\n      activity = _useActivity2[0],\n      _useActivity2$ = _useActivity2[1],\n      start = _useActivity2$.start,\n      stop = _useActivity2$.stop,\n      delayStart = _useActivity2$.delayStart;\n\n  var active = activity === TapState.active || activity === TapState.exiting;\n  var containerRef = useExternRef(getRootRef); // hover propagation\n\n  var childContext = React.useRef({\n    onHoverChange: setChildHover\n  }).current;\n  useIsomorphicLayoutEffect(function () {\n    if (!hovered) {\n      return noop;\n    }\n\n    onHoverChange(true);\n    return function () {\n      return onHoverChange(false);\n    };\n  }, [hovered]);\n  /*\n   * [a11y]\n   * Обрабатывает событие onkeydown\n   * для кастомных доступных элементов:\n   * - role=\"link\" (активация по Enter)\n   * - role=\"button\" (активация по Space и Enter)\n   */\n\n  function onKeyDown(e) {\n    if (isCustomElement && shouldTriggerClickOnEnterOrSpace(e)) {\n      var _containerRef$current;\n\n      e.preventDefault();\n      (_containerRef$current = containerRef.current) === null || _containerRef$current === void 0 ? void 0 : _containerRef$current.click();\n    }\n  }\n\n  var needWaves = platform === Platform.ANDROID && !hasPointerContext && hasActive && activeMode === 'background';\n  var clearClicks = useTimeout(function () {\n    return setClicks([]);\n  }, WAVE_LIVE);\n\n  function addClick(x, y) {\n    var dateNow = Date.now();\n    var filteredClicks = clicks.filter(function (click) {\n      return click.id + WAVE_LIVE > dateNow;\n    });\n    setClicks([].concat(_toConsumableArray(filteredClicks), [{\n      x: x,\n      y: y,\n      id: dateNow\n    }]));\n    clearClicks.set();\n  }\n\n  function onStart(_ref2) {\n    var originalEvent = _ref2.originalEvent;\n\n    if (hasActive) {\n      if (originalEvent.touches && originalEvent.touches.length > 1) {\n        // r сожалению я так и не понял, что это делает и можно ли упихнуть его в Touch\n        return stop();\n      }\n\n      if (needWaves) {\n        var _getOffsetRect = getOffsetRect(containerRef.current),\n            top = _getOffsetRect.top,\n            left = _getOffsetRect.left;\n\n        var x = coordX(originalEvent) - (left !== null && left !== void 0 ? left : 0);\n        var y = coordY(originalEvent) - (top !== null && top !== void 0 ? top : 0);\n        addClick(x, y);\n      }\n\n      delayStart();\n    }\n  }\n\n  function onMove(_ref3) {\n    var isSlide = _ref3.isSlide;\n\n    if (isSlide) {\n      stop();\n    }\n  }\n\n  function onEnd(_ref4) {\n    var duration = _ref4.duration;\n\n    if (activity === TapState.none) {\n      return;\n    }\n\n    if (activity === TapState.pending) {\n      // активировать при коротком тапе\n      start();\n    } // отключить без задержки при длинном тапе\n\n\n    var activeDuration = duration - ACTIVE_DELAY;\n    stop(activeDuration >= 100 ? 0 : activeEffectDelay - activeDuration);\n  }\n\n  var classes = classNames(className, \"vkuiTappable\", platform === Platform.IOS && \"vkuiTappable--ios\", sizeXClassNames[sizeX], hasHoverContext && \"vkuiTappable--hover-has\", hasActive && \"vkuiTappable--hasActive\", hasHover && hovered && !isPresetHoverMode && hoverMode, hasActive && active && !isPresetActiveMode && activeMode, focusVisible && !isPresetFocusVisibleMode && focusVisibleMode, hasActive && active && \"vkuiTappable--active\", hasHover && hovered && isPresetHoverMode && styles[\"Tappable--hover-\".concat(hoverMode)], hasActive && active && isPresetActiveMode && styles[\"Tappable--active-\".concat(activeMode)], focusVisible && \"vkuiTappable--focus-visible\");\n  var handlers = {\n    onStart: callMultiple(onStart, props.onStart),\n    onMove: callMultiple(onMove, props.onMove),\n    onEnd: callMultiple(onEnd, props.onEnd),\n    onClick: onClick,\n    onKeyDown: callMultiple(onKeyDown, _onKeyDown)\n  };\n  var role = props.href ? 'link' : 'button';\n  return /*#__PURE__*/React.createElement(Touch, _extends({\n    onEnter: callMultiple(setHoveredTrue, onEnter),\n    onLeave: callMultiple(setHoveredFalse, onLeave),\n    type: Component === 'button' ? 'button' : undefined,\n    tabIndex: isCustomElement && !props.disabled ? 0 : undefined,\n    role: isCustomElement ? role : undefined,\n    \"aria-disabled\": isCustomElement ? props.disabled : undefined,\n    stopPropagation: stopPropagation && !insideTouchRoot && !props.disabled\n  }, props, {\n    slideThreshold: 20,\n    usePointerHover: true,\n    className: classes,\n    Component: Component,\n    getRootRef: containerRef,\n    onBlur: callMultiple(onBlur, props.onBlur),\n    onFocus: callMultiple(onFocus, props.onFocus)\n  }, props.disabled ? {} : handlers), /*#__PURE__*/React.createElement(TappableContext.Provider, {\n    value: childContext\n  }, children), needWaves && /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": true,\n    className: \"vkuiTappable__waves\"\n  }, clicks.map(function (wave) {\n    return /*#__PURE__*/React.createElement(\"span\", {\n      key: wave.id,\n      className: \"vkuiTappable__wave\",\n      style: {\n        top: wave.y,\n        left: wave.x\n      }\n    });\n  })), (hasHover && hoverMode === 'background' || hasActive && activeMode === 'background') && /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": true,\n    className: \"vkuiTappable__stateLayer\"\n  }), !props.disabled && isPresetFocusVisibleMode && /*#__PURE__*/React.createElement(FocusVisible, {\n    mode: focusVisibleMode\n  }));\n};\nvar styles = {\n  \"Tappable--hover-has\": \"vkuiTappable--hover-has\",\n  \"Tappable--hover-background\": \"vkuiTappable--hover-background\",\n  \"Tappable--hover-opacity\": \"vkuiTappable--hover-opacity\",\n  \"Tappable--active-background\": \"vkuiTappable--active-background\",\n  \"Tappable--active-opacity\": \"vkuiTappable--active-opacity\"\n};","map":{"version":3,"mappings":"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","names":["React","mitt","classNames","noop","Touch","TouchRootContext","Platform","getOffsetRect","coordX","coordY","shouldTriggerClickOnEnterOrSpace","useIsomorphicLayoutEffect","FocusVisible","useTimeout","useExternRef","usePlatform","useFocusVisible","callMultiple","useBooleanState","useAdaptivity","useAdaptivityHasHover","useAdaptivityHasPointer","sizeXClassNames","none","compact","regular","WAVE_LIVE","ACTIVE_DELAY","ACTIVE_EFFECT_DELAY","activeBus","TapState","pending","active","exiting","TappableContext","createContext","onHoverChange","isPresetStateMode","stateMode","useActivity","hasActive","stopDelay","id","useMemo","Math","round","random","toString","useState","_React$useState2","activity","setActivity","_stop","start","delayStart","activeTimeout","stopTimeout","set","clear","emit","onActiveChange","activeId","on","off","stop","delay","Tappable","_ref","children","Component","onClick","_onKeyDown","onKeyDown","_ref$activeEffectDela","activeEffectDelay","_ref$stopPropagation","stopPropagation","getRootRef","_ref$hasHover","hasHover","_hasHover","_ref$hoverMode","hoverMode","_ref$hasActive","_hasActive","_ref$activeMode","activeMode","_ref$focusVisibleMode","focusVisibleMode","onEnter","onLeave","className","props","href","useContext","insideTouchRoot","platform","focusVisible","onBlur","onFocus","_useAdaptivity$sizeX","sizeX","hasPointerContext","hasHoverContext","_React$useState4","clicks","setClicks","_React$useState6","childHover","setChildHover","_hovered","value","setHoveredTrue","setTrue","setHoveredFalse","setFalse","hovered","disabled","isCustomElement","contentEditable","isPresetHoverMode","isPresetActiveMode","isPresetFocusVisibleMode","includes","_useActivity2","_useActivity2$","containerRef","childContext","useRef","current","e","preventDefault","_containerRef$current","click","needWaves","ANDROID","clearClicks","addClick","x","y","dateNow","Date","now","filteredClicks","filter","onStart","_ref2","originalEvent","touches","length","top","left","onMove","_ref3","isSlide","onEnd","_ref4","duration","activeDuration","classes","IOS","styles","handlers","role","_extends","type","undefined","tabIndex","slideThreshold","usePointerHover","Provider","map","wave","key","style","mode"],"sources":["/Users/pitus_anonimous/Desktop/youth_bit_hack/youth_bit_vk/node_modules/@vkontakte/vkui/src/components/Tappable/Tappable.tsx"],"sourcesContent":["import * as React from 'react';\nimport mitt from 'mitt';\nimport { classNames, noop } from '@vkontakte/vkjs';\nimport { Touch, TouchEvent, TouchProps } from '../Touch/Touch';\nimport TouchRootContext from '../Touch/TouchContext';\nimport { Platform } from '../../lib/platform';\nimport { getOffsetRect } from '../../lib/offset';\nimport { coordX, coordY } from '../../lib/touch';\nimport { AnchorHTMLAttributesOnly, HasComponent, HasRootRef } from '../../types';\nimport { shouldTriggerClickOnEnterOrSpace } from '../../lib/accessibility';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { FocusVisible, FocusVisibleMode } from '../FocusVisible/FocusVisible';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useFocusVisible } from '../../hooks/useFocusVisible';\nimport { callMultiple } from '../../lib/callMultiple';\nimport { useBooleanState } from '../../hooks/useBooleanState';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useAdaptivityHasHover } from '../../hooks/useAdaptivityHasHover';\nimport { useAdaptivityHasPointer } from '../../hooks/useAdaptivityHasPointer';\nimport styles from './Tappable.module.css';\n\nconst sizeXClassNames = {\n  none: styles['Tappable--sizeX-none'],\n  compact: styles['Tappable--sizeX-compact'],\n  regular: styles['Tappable--sizeX-regular'],\n};\n\ntype StateMode = 'opacity' | 'background';\n\nconst WAVE_LIVE = 225;\n\nexport type TappableElementProps = Omit<\n  React.AllHTMLAttributes<HTMLElement>,\n  | 'onTouchStart'\n  | 'onTouchMove'\n  | 'onTouchEnd'\n  | 'onTouchCancel'\n  | 'onMouseDown'\n  | 'onMouseMove'\n  | 'onMouseUp'\n  | 'onMouseLeave'\n> &\n  AnchorHTMLAttributesOnly; // В AllHTMLAttributes не хватает типов для ссылок\n\nexport interface TappableProps\n  extends TappableElementProps,\n    HasRootRef<HTMLElement>,\n    HasComponent,\n    Pick<TouchProps, 'onStart' | 'onEnd' | 'onMove'> {\n  /**\n   * Длительность показа active-состояния\n   */\n  activeEffectDelay?: number;\n  stopPropagation?: boolean;\n  /**\n   * Указывает, должен ли компонент реагировать на hover-состояние\n   */\n  hasHover?: boolean;\n  /**\n   * Указывает, должен ли компонент реагировать на active-состояние\n   */\n  hasActive?: boolean;\n  /**\n   * Стиль подсветки active-состояния. Если передать произвольную строку, она добавится как css-класс во время active\n   */\n  activeMode?: StateMode | string;\n  /**\n   * Стиль подсветки hover-состояния. Если передать произвольную строку, она добавится как css-класс во время hover\n   */\n  hoverMode?: StateMode | string;\n  /**\n   * Стиль аутлайна focus visible. Если передать произвольную строку, она добавится как css-класс во время focus-visible\n   */\n  focusVisibleMode?: FocusVisibleMode | string;\n  children?: React.ReactNode;\n  onEnter?(outputEvent: MouseEvent): void;\n  onLeave?(outputEvent: MouseEvent): void;\n}\n\ninterface Wave {\n  x: number;\n  y: number;\n  id: number;\n}\n\nexport interface RootComponentProps extends TouchProps {\n  ref?: React.Ref<HTMLElement>;\n}\n\nexport const ACTIVE_DELAY = 70;\nexport const ACTIVE_EFFECT_DELAY = 600;\n\nconst activeBus = mitt<{ active: string }>();\nconst TapState = { none: 0, pending: 1, active: 2, exiting: 3 } as const;\n\ntype TappableContextInterface = { onHoverChange: (s: boolean) => void };\nconst TappableContext = React.createContext<TappableContextInterface>({\n  onHoverChange: noop,\n});\n\nfunction isPresetStateMode(stateMode: StateMode | string): stateMode is StateMode {\n  switch (stateMode) {\n    case 'opacity':\n    case 'background':\n      return true;\n    default:\n      return false;\n  }\n}\n\nfunction useActivity(hasActive: boolean, stopDelay: number) {\n  const id = React.useMemo(() => Math.round(Math.random() * 1e8).toString(16), []);\n\n  const [activity, setActivity] = React.useState<(typeof TapState)[keyof typeof TapState]>(\n    TapState.none,\n  );\n  const _stop = () => setActivity(TapState.none);\n  const start = () => hasActive && setActivity(TapState.active);\n  const delayStart = () => {\n    hasActive && setActivity(TapState.pending);\n  };\n\n  const activeTimeout = useTimeout(start, ACTIVE_DELAY);\n  const stopTimeout = useTimeout(_stop, stopDelay);\n\n  useIsomorphicLayoutEffect(() => {\n    if (activity === TapState.pending) {\n      activeTimeout.set();\n      return activeTimeout.clear;\n    }\n    if (activity === TapState.exiting) {\n      return stopTimeout.clear;\n    }\n    if (activity === TapState.active) {\n      activeBus.emit('active', id);\n    }\n    return noop;\n  }, [activity]);\n\n  useIsomorphicLayoutEffect(() => {\n    if (activity === TapState.none) {\n      return noop;\n    }\n    const onActiveChange = (activeId: string) => {\n      activeId !== id && _stop();\n    };\n    activeBus.on('active', onActiveChange);\n    return () => activeBus.off('active', onActiveChange);\n  }, [activity === TapState.none]);\n\n  useIsomorphicLayoutEffect(() => {\n    !hasActive && _stop();\n  }, [hasActive]);\n\n  const stop = (delay?: number) => {\n    if (delay) {\n      setActivity(TapState.exiting);\n      return stopTimeout.set(delay);\n    }\n    _stop();\n  };\n\n  return [activity, { delayStart, start, stop }] as const;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Tappable\n */\nexport const Tappable = ({\n  children,\n  Component,\n  onClick,\n  onKeyDown: _onKeyDown,\n  activeEffectDelay = ACTIVE_EFFECT_DELAY,\n  stopPropagation = false,\n  getRootRef,\n  hasHover: _hasHover = true,\n  hoverMode = 'background',\n  hasActive: _hasActive = true,\n  activeMode = 'background',\n  focusVisibleMode = 'inside',\n  onEnter,\n  onLeave,\n  className,\n  ...props\n}: TappableProps) => {\n  Component = Component || ((props.href ? 'a' : 'div') as React.ElementType);\n\n  const { onHoverChange } = React.useContext(TappableContext);\n  const insideTouchRoot = React.useContext(TouchRootContext);\n  const platform = usePlatform();\n  const { focusVisible, onBlur, onFocus } = useFocusVisible();\n  const { sizeX = 'none' } = useAdaptivity();\n  const hasPointerContext = useAdaptivityHasPointer();\n  const hasHoverContext = useAdaptivityHasHover();\n\n  const [clicks, setClicks] = React.useState<Wave[]>([]);\n  const [childHover, setChildHover] = React.useState(false);\n  const {\n    value: _hovered,\n    setTrue: setHoveredTrue,\n    setFalse: setHoveredFalse,\n  } = useBooleanState(false);\n\n  const hovered = _hovered && !props.disabled;\n  const hasActive = _hasActive && !childHover && !props.disabled;\n  const hasHover = hasHoverContext && _hasHover && !childHover;\n  const isCustomElement =\n    Component !== 'a' && Component !== 'button' && Component !== 'label' && !props.contentEditable;\n  const isPresetHoverMode = isPresetStateMode(hoverMode);\n  const isPresetActiveMode = isPresetStateMode(activeMode);\n  const isPresetFocusVisibleMode = ['inside', 'outside'].includes(focusVisibleMode);\n\n  const [activity, { start, stop, delayStart }] = useActivity(hasActive, activeEffectDelay);\n  const active = activity === TapState.active || activity === TapState.exiting;\n\n  const containerRef = useExternRef(getRootRef);\n\n  // hover propagation\n  const childContext = React.useRef({ onHoverChange: setChildHover }).current;\n  useIsomorphicLayoutEffect(() => {\n    if (!hovered) {\n      return noop;\n    }\n    onHoverChange(true);\n    return () => onHoverChange(false);\n  }, [hovered]);\n\n  /*\n   * [a11y]\n   * Обрабатывает событие onkeydown\n   * для кастомных доступных элементов:\n   * - role=\"link\" (активация по Enter)\n   * - role=\"button\" (активация по Space и Enter)\n   */\n  function onKeyDown(e: React.KeyboardEvent<HTMLElement>) {\n    if (isCustomElement && shouldTriggerClickOnEnterOrSpace(e)) {\n      e.preventDefault();\n      containerRef.current?.click();\n    }\n  }\n\n  const needWaves =\n    platform === Platform.ANDROID && !hasPointerContext && hasActive && activeMode === 'background';\n\n  const clearClicks = useTimeout(() => setClicks([]), WAVE_LIVE);\n\n  function addClick(x: number, y: number) {\n    const dateNow = Date.now();\n    const filteredClicks = clicks.filter((click) => click.id + WAVE_LIVE > dateNow);\n\n    setClicks([...filteredClicks, { x, y, id: dateNow }]);\n    clearClicks.set();\n  }\n\n  function onStart({ originalEvent }: TouchEvent) {\n    if (hasActive) {\n      if (originalEvent.touches && originalEvent.touches.length > 1) {\n        // r сожалению я так и не понял, что это делает и можно ли упихнуть его в Touch\n        return stop();\n      }\n\n      if (needWaves) {\n        const { top, left } = getOffsetRect(containerRef.current);\n        const x = coordX(originalEvent) - (left ?? 0);\n        const y = coordY(originalEvent) - (top ?? 0);\n        addClick(x, y);\n      }\n\n      delayStart();\n    }\n  }\n\n  function onMove({ isSlide }: TouchEvent) {\n    if (isSlide) {\n      stop();\n    }\n  }\n\n  function onEnd({ duration }: TouchEvent) {\n    if (activity === TapState.none) {\n      return;\n    }\n    if (activity === TapState.pending) {\n      // активировать при коротком тапе\n      start();\n    }\n\n    // отключить без задержки при длинном тапе\n    const activeDuration = duration - ACTIVE_DELAY;\n    stop(activeDuration >= 100 ? 0 : activeEffectDelay - activeDuration);\n  }\n\n  const classes = classNames(\n    className,\n    styles['Tappable'],\n    platform === Platform.IOS && styles['Tappable--ios'],\n    sizeXClassNames[sizeX],\n    hasHoverContext && styles['Tappable--hover-has'],\n    hasActive && styles['Tappable--hasActive'],\n    hasHover && hovered && !isPresetHoverMode && hoverMode,\n    hasActive && active && !isPresetActiveMode && activeMode,\n    focusVisible && !isPresetFocusVisibleMode && focusVisibleMode,\n    hasActive && active && styles['Tappable--active'],\n    hasHover && hovered && isPresetHoverMode && styles[`Tappable--hover-${hoverMode}`],\n    hasActive && active && isPresetActiveMode && styles[`Tappable--active-${activeMode}`],\n    focusVisible && styles['Tappable--focus-visible'],\n  );\n\n  const handlers: RootComponentProps = {\n    onStart: callMultiple(onStart, props.onStart),\n    onMove: callMultiple(onMove, props.onMove),\n    onEnd: callMultiple(onEnd, props.onEnd),\n    onClick,\n    onKeyDown: callMultiple(onKeyDown, _onKeyDown),\n  };\n  const role = props.href ? 'link' : 'button';\n\n  return (\n    <Touch\n      onEnter={callMultiple(setHoveredTrue, onEnter)}\n      onLeave={callMultiple(setHoveredFalse, onLeave)}\n      type={Component === 'button' ? 'button' : undefined}\n      tabIndex={isCustomElement && !props.disabled ? 0 : undefined}\n      role={isCustomElement ? role : undefined}\n      aria-disabled={isCustomElement ? props.disabled : undefined}\n      stopPropagation={stopPropagation && !insideTouchRoot && !props.disabled}\n      {...props}\n      slideThreshold={20}\n      usePointerHover\n      className={classes}\n      Component={Component}\n      getRootRef={containerRef}\n      onBlur={callMultiple(onBlur, props.onBlur)}\n      onFocus={callMultiple(onFocus, props.onFocus)}\n      {...(props.disabled ? {} : handlers)}\n    >\n      <TappableContext.Provider value={childContext}>{children}</TappableContext.Provider>\n      {needWaves && (\n        <span aria-hidden className={styles.Tappable__waves}>\n          {clicks.map((wave) => (\n            <span\n              key={wave.id}\n              className={styles.Tappable__wave}\n              style={{ top: wave.y, left: wave.x }}\n            />\n          ))}\n        </span>\n      )}\n      {((hasHover && hoverMode === 'background') || (hasActive && activeMode === 'background')) && (\n        <span aria-hidden className={styles.Tappable__stateLayer} />\n      )}\n      {!props.disabled && isPresetFocusVisibleMode && (\n        <FocusVisible mode={focusVisibleMode as FocusVisibleMode} />\n      )}\n    </Touch>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}