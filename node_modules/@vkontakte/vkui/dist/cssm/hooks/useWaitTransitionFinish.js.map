{"version":3,"file":"useWaitTransitionFinish.js","names":["React","useDOM","noop","transitionEvent","useWaitTransitionFinish","timeoutRef","useRef","document","detach","remove","useCallback","current","waitTransitionFinish","element","eventHandler","durationFallback","hidden","supported","name","addEventListener","removeEventListener","clearTimeout","setTimeout"],"sources":["../../../src/hooks/useWaitTransitionFinish.ts"],"sourcesContent":["import * as React from 'react';\nimport { useDOM } from '../lib/dom';\nimport { noop } from '@vkontakte/vkjs';\nimport { transitionEvent } from '../lib/supportEvents';\n\nexport const useWaitTransitionFinish = () => {\n  const timeoutRef = React.useRef<ReturnType<typeof setTimeout> | null>(null);\n  const { document } = useDOM();\n  const detach = React.useRef(noop);\n\n  const remove = React.useCallback(() => {\n    detach.current();\n    detach.current = noop;\n  }, []);\n\n  const waitTransitionFinish = React.useCallback(\n    (element: HTMLElement | null, eventHandler: VoidFunction, durationFallback: number) => {\n      if (element) {\n        if (!document?.hidden && transitionEvent.supported && transitionEvent.name) {\n          remove();\n          element.addEventListener(transitionEvent.name, eventHandler);\n          detach.current = () => {\n            if (transitionEvent.name) {\n              element.removeEventListener(transitionEvent.name, eventHandler);\n            }\n          };\n        } else {\n          if (timeoutRef?.current) {\n            clearTimeout(timeoutRef.current);\n          }\n          timeoutRef.current = setTimeout(eventHandler, durationFallback);\n        }\n      }\n    },\n    [document, remove, timeoutRef],\n  );\n\n  return {\n    waitTransitionFinish,\n  };\n};\n"],"mappings":"AAAA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,SAASC,MAAM,QAAQ,YAAY;AACnC,SAASC,IAAI,QAAQ,iBAAiB;AACtC,SAASC,eAAe,QAAQ,sBAAsB;AAEtD,OAAO,IAAMC,uBAAuB,GAAG,SAA1BA,uBAAuB,GAAS;EAC3C,IAAMC,UAAU,GAAGL,KAAK,CAACM,MAAM,CAAuC,IAAI,CAAC;EAC3E,cAAqBL,MAAM,EAAE;IAArBM,QAAQ,WAARA,QAAQ;EAChB,IAAMC,MAAM,GAAGR,KAAK,CAACM,MAAM,CAACJ,IAAI,CAAC;EAEjC,IAAMO,MAAM,GAAGT,KAAK,CAACU,WAAW,CAAC,YAAM;IACrCF,MAAM,CAACG,OAAO,EAAE;IAChBH,MAAM,CAACG,OAAO,GAAGT,IAAI;EACvB,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMU,oBAAoB,GAAGZ,KAAK,CAACU,WAAW,CAC5C,UAACG,OAA2B,EAAEC,YAA0B,EAAEC,gBAAwB,EAAK;IACrF,IAAIF,OAAO,EAAE;MACX,IAAI,EAACN,QAAQ,aAARA,QAAQ,eAARA,QAAQ,CAAES,MAAM,KAAIb,eAAe,CAACc,SAAS,IAAId,eAAe,CAACe,IAAI,EAAE;QAC1ET,MAAM,EAAE;QACRI,OAAO,CAACM,gBAAgB,CAAChB,eAAe,CAACe,IAAI,EAAEJ,YAAY,CAAC;QAC5DN,MAAM,CAACG,OAAO,GAAG,YAAM;UACrB,IAAIR,eAAe,CAACe,IAAI,EAAE;YACxBL,OAAO,CAACO,mBAAmB,CAACjB,eAAe,CAACe,IAAI,EAAEJ,YAAY,CAAC;UACjE;QACF,CAAC;MACH,CAAC,MAAM;QACL,IAAIT,UAAU,aAAVA,UAAU,eAAVA,UAAU,CAAEM,OAAO,EAAE;UACvBU,YAAY,CAAChB,UAAU,CAACM,OAAO,CAAC;QAClC;QACAN,UAAU,CAACM,OAAO,GAAGW,UAAU,CAACR,YAAY,EAAEC,gBAAgB,CAAC;MACjE;IACF;EACF,CAAC,EACD,CAACR,QAAQ,EAAEE,MAAM,EAAEJ,UAAU,CAAC,CAC/B;EAED,OAAO;IACLO,oBAAoB,EAApBA;EACF,CAAC;AACH,CAAC"}