{"version":3,"file":"Calendar.js","names":["React","isSameMonth","isSameDay","CalendarHeader","CalendarDays","CalendarTime","useIsomorphicLayoutEffect","navigateDate","setTimeEqual","isFirstDay","isLastDay","useCalendar","classNames","warnOnce","warn","Calendar","value","onChange","disablePast","disableFuture","shouldDisableDate","onClose","enableTime","doneButtonText","weekStartsOn","getRootRef","disablePickers","changeHoursAriaLabel","changeMinutesAriaLabel","prevMonthAriaLabel","nextMonthAriaLabel","changeMonthAriaLabel","changeYearAriaLabel","showNeighboringMonth","changeDayAriaLabel","size","externalViewDate","viewDate","onHeaderChange","onNextMonth","onPrevMonth","prevMonthIcon","nextMonthIcon","prevMonthProps","nextMonthProps","dayProps","className","listenDayChangesForUpdate","props","setViewDate","setPrevMonth","setNextMonth","focusedDay","setFocusedDay","isDayFocused","isDayDisabled","resetSelectedDay","process","env","NODE_ENV","handleKeyDown","useCallback","event","includes","key","preventDefault","newFocusedDay","onDayChange","date","isDayActive","day","Boolean","styles"],"sources":["../../../../src/components/Calendar/Calendar.tsx"],"sourcesContent":["import * as React from 'react';\nimport { isSameMonth, isSameDay } from '../../lib/date';\nimport { CalendarHeader, CalendarHeaderProps } from '../CalendarHeader/CalendarHeader';\nimport { CalendarDays, CalendarDaysProps } from '../CalendarDays/CalendarDays';\nimport { CalendarTime, CalendarTimeProps } from '../CalendarTime/CalendarTime';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { navigateDate, setTimeEqual, isFirstDay, isLastDay } from '../../lib/calendar';\nimport { useCalendar } from '../../hooks/useCalendar';\nimport { HasRootRef } from '../../types';\nimport { classNames } from '@vkontakte/vkjs';\nimport { warnOnce } from '../../lib/warnOnce';\nimport styles from './Calendar.module.css';\n\nexport interface CalendarProps\n  extends Omit<React.HTMLAttributes<HTMLDivElement>, 'onChange'>,\n    Pick<CalendarTimeProps, 'changeHoursAriaLabel' | 'changeMinutesAriaLabel'>,\n    Pick<\n      CalendarHeaderProps,\n      | 'prevMonthAriaLabel'\n      | 'nextMonthAriaLabel'\n      | 'changeMonthAriaLabel'\n      | 'changeYearAriaLabel'\n      | 'onNextMonth'\n      | 'onPrevMonth'\n      | 'prevMonthIcon'\n      | 'nextMonthIcon'\n      | 'prevMonthProps'\n      | 'nextMonthProps'\n    >,\n    Pick<CalendarDaysProps, 'dayProps' | 'listenDayChangesForUpdate'>,\n    HasRootRef<HTMLDivElement> {\n  value?: Date;\n  disablePast?: boolean;\n  disableFuture?: boolean;\n  enableTime?: boolean;\n  disablePickers?: boolean;\n  doneButtonText?: string;\n  changeDayAriaLabel?: string;\n  weekStartsOn?: 0 | 1 | 2 | 3 | 4 | 5 | 6;\n  showNeighboringMonth?: boolean;\n  size?: 's' | 'm';\n  onChange?(value?: Date): void;\n  shouldDisableDate?(value: Date): boolean;\n  onClose?(): void;\n  /**\n   * Дата отображаемого месяца.\n   * При использовании обновление даты должно происходить вне компонента.\n   */\n  viewDate?: Date;\n  /**\n   * Изменение даты в шапке календаря.\n   */\n  onHeaderChange?(value: Date): void;\n}\n\nconst warn = warnOnce('Calendar');\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Calendar\n */\nexport const Calendar = ({\n  value,\n  onChange,\n  disablePast,\n  disableFuture,\n  shouldDisableDate,\n  onClose,\n  enableTime = false,\n  doneButtonText,\n  weekStartsOn = 1,\n  getRootRef,\n  disablePickers,\n  changeHoursAriaLabel,\n  changeMinutesAriaLabel,\n  prevMonthAriaLabel,\n  nextMonthAriaLabel,\n  changeMonthAriaLabel,\n  changeYearAriaLabel,\n  showNeighboringMonth,\n  changeDayAriaLabel = 'Изменить день',\n  size = 'm',\n  viewDate: externalViewDate,\n  onHeaderChange,\n  onNextMonth,\n  onPrevMonth,\n  prevMonthIcon,\n  nextMonthIcon,\n  prevMonthProps,\n  nextMonthProps,\n  dayProps,\n  className,\n  listenDayChangesForUpdate,\n  ...props\n}: CalendarProps) => {\n  const {\n    viewDate,\n    setViewDate,\n    setPrevMonth,\n    setNextMonth,\n    focusedDay,\n    setFocusedDay,\n    isDayFocused,\n    isDayDisabled,\n    resetSelectedDay,\n  } = useCalendar({\n    value,\n    disableFuture,\n    disablePast,\n    shouldDisableDate,\n    onHeaderChange,\n    onNextMonth,\n    onPrevMonth,\n  });\n\n  useIsomorphicLayoutEffect(() => {\n    if (value) {\n      setViewDate(value);\n    }\n  }, [value]);\n\n  if (process.env.NODE_ENV === 'development' && !disablePickers && size === 's') {\n    warn(\"Нельзя включить селекты выбора месяца/года, если размер календаря 's'\", 'error');\n  }\n\n  if (process.env.NODE_ENV === 'development' && enableTime && size === 's') {\n    warn(\"Нельзя включить выбор времени, если размер календаря 's'\", 'error');\n  }\n\n  const handleKeyDown = React.useCallback(\n    (event: React.KeyboardEvent) => {\n      if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key)) {\n        event.preventDefault();\n      }\n\n      const newFocusedDay = navigateDate(focusedDay ?? value, event.key);\n\n      if (newFocusedDay && !isSameMonth(newFocusedDay, viewDate)) {\n        setViewDate(newFocusedDay);\n      }\n      setFocusedDay(newFocusedDay);\n    },\n    [focusedDay, setFocusedDay, setViewDate, value, viewDate],\n  );\n\n  const onDayChange = React.useCallback(\n    (date: Date) => {\n      onChange?.(setTimeEqual(date, value as Date | undefined | null));\n    },\n    [value, onChange],\n  );\n\n  const isDayActive = React.useCallback(\n    (day: Date) => Boolean(value && isSameDay(day, value)),\n    [value],\n  );\n\n  return (\n    <div\n      {...props}\n      ref={getRootRef}\n      className={classNames(styles['Calendar'], styles[`Calendar--size-${size}`], className)}\n    >\n      <CalendarHeader\n        viewDate={externalViewDate || viewDate}\n        onChange={setViewDate}\n        onNextMonth={setNextMonth}\n        onPrevMonth={setPrevMonth}\n        disablePickers={disablePickers || size === 's'}\n        className={styles['Calendar__header']}\n        prevMonthAriaLabel={prevMonthAriaLabel}\n        nextMonthAriaLabel={nextMonthAriaLabel}\n        changeMonthAriaLabel={changeMonthAriaLabel}\n        changeYearAriaLabel={changeYearAriaLabel}\n        prevMonthIcon={prevMonthIcon}\n        nextMonthIcon={nextMonthIcon}\n        prevMonthProps={prevMonthProps}\n        nextMonthProps={nextMonthProps}\n      />\n      <CalendarDays\n        viewDate={externalViewDate || viewDate}\n        value={value}\n        weekStartsOn={weekStartsOn}\n        isDayFocused={isDayFocused}\n        tabIndex={0}\n        aria-label={changeDayAriaLabel}\n        onKeyDown={handleKeyDown}\n        onDayChange={onDayChange}\n        isDayActive={isDayActive}\n        isDaySelectionStart={isFirstDay}\n        isDaySelectionEnd={isLastDay}\n        isDayDisabled={isDayDisabled}\n        onBlur={resetSelectedDay}\n        showNeighboringMonth={showNeighboringMonth}\n        size={size}\n        dayProps={dayProps}\n        listenDayChangesForUpdate={listenDayChangesForUpdate}\n      />\n      {enableTime && value && size !== 's' && (\n        <div className={styles['Calendar__time']}>\n          <CalendarTime\n            value={value}\n            onChange={onChange}\n            onClose={onClose}\n            doneButtonText={doneButtonText}\n            changeHoursAriaLabel={changeHoursAriaLabel}\n            changeMinutesAriaLabel={changeMinutesAriaLabel}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n"],"mappings":";;;AAAA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,SAASC,WAAW,EAAEC,SAAS,QAAQ,gBAAgB;AACvD,SAASC,cAAc,QAA6B,kCAAkC;AACtF,SAASC,YAAY,QAA2B,8BAA8B;AAC9E,SAASC,YAAY,QAA2B,8BAA8B;AAC9E,SAASC,yBAAyB,QAAQ,qCAAqC;AAC/E,SAASC,YAAY,EAAEC,YAAY,EAAEC,UAAU,EAAEC,SAAS,QAAQ,oBAAoB;AACtF,SAASC,WAAW,QAAQ,yBAAyB;AAErD,SAASC,UAAU,QAAQ,iBAAiB;AAC5C,SAASC,QAAQ,QAAQ,oBAAoB;AAAC;AA6C9C,IAAMC,IAAI,GAAGD,QAAQ,CAAC,UAAU,CAAC;;AAEjC;AACA;AACA;AACA,OAAO,IAAME,QAAQ,GAAG,SAAXA,QAAQ,OAiCA;EAAA,IAhCnBC,KAAK,QAALA,KAAK;IACLC,QAAQ,QAARA,QAAQ;IACRC,WAAW,QAAXA,WAAW;IACXC,aAAa,QAAbA,aAAa;IACbC,iBAAiB,QAAjBA,iBAAiB;IACjBC,OAAO,QAAPA,OAAO;IAAA,uBACPC,UAAU;IAAVA,UAAU,gCAAG,KAAK;IAClBC,cAAc,QAAdA,cAAc;IAAA,yBACdC,YAAY;IAAZA,YAAY,kCAAG,CAAC;IAChBC,UAAU,QAAVA,UAAU;IACVC,cAAc,QAAdA,cAAc;IACdC,oBAAoB,QAApBA,oBAAoB;IACpBC,sBAAsB,QAAtBA,sBAAsB;IACtBC,kBAAkB,QAAlBA,kBAAkB;IAClBC,kBAAkB,QAAlBA,kBAAkB;IAClBC,oBAAoB,QAApBA,oBAAoB;IACpBC,mBAAmB,QAAnBA,mBAAmB;IACnBC,oBAAoB,QAApBA,oBAAoB;IAAA,6BACpBC,kBAAkB;IAAlBA,kBAAkB,sCAAG,eAAe;IAAA,iBACpCC,IAAI;IAAJA,IAAI,0BAAG,GAAG;IACAC,gBAAgB,QAA1BC,QAAQ;IACRC,cAAc,QAAdA,cAAc;IACdC,WAAW,QAAXA,WAAW;IACXC,WAAW,QAAXA,WAAW;IACXC,aAAa,QAAbA,aAAa;IACbC,aAAa,QAAbA,aAAa;IACbC,cAAc,QAAdA,cAAc;IACdC,cAAc,QAAdA,cAAc;IACdC,QAAQ,QAARA,QAAQ;IACRC,SAAS,QAATA,SAAS;IACTC,yBAAyB,QAAzBA,yBAAyB;IACtBC,KAAK;EAER,mBAUIrC,WAAW,CAAC;MACdK,KAAK,EAALA,KAAK;MACLG,aAAa,EAAbA,aAAa;MACbD,WAAW,EAAXA,WAAW;MACXE,iBAAiB,EAAjBA,iBAAiB;MACjBkB,cAAc,EAAdA,cAAc;MACdC,WAAW,EAAXA,WAAW;MACXC,WAAW,EAAXA;IACF,CAAC,CAAC;IAjBAH,QAAQ,gBAARA,QAAQ;IACRY,WAAW,gBAAXA,WAAW;IACXC,YAAY,gBAAZA,YAAY;IACZC,YAAY,gBAAZA,YAAY;IACZC,UAAU,gBAAVA,UAAU;IACVC,aAAa,gBAAbA,aAAa;IACbC,YAAY,gBAAZA,YAAY;IACZC,aAAa,gBAAbA,aAAa;IACbC,gBAAgB,gBAAhBA,gBAAgB;EAWlBlD,yBAAyB,CAAC,YAAM;IAC9B,IAAIU,KAAK,EAAE;MACTiC,WAAW,CAACjC,KAAK,CAAC;IACpB;EACF,CAAC,EAAE,CAACA,KAAK,CAAC,CAAC;EAEX,IAAIyC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,IAAI,CAACjC,cAAc,IAAIS,IAAI,KAAK,GAAG,EAAE;IAC7ErB,IAAI,CAAC,uEAAuE,EAAE,OAAO,CAAC;EACxF;EAEA,IAAI2C,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,IAAIrC,UAAU,IAAIa,IAAI,KAAK,GAAG,EAAE;IACxErB,IAAI,CAAC,0DAA0D,EAAE,OAAO,CAAC;EAC3E;EAEA,IAAM8C,aAAa,GAAG5D,KAAK,CAAC6D,WAAW,CACrC,UAACC,KAA0B,EAAK;IAC9B,IAAI,CAAC,SAAS,EAAE,WAAW,EAAE,WAAW,EAAE,YAAY,CAAC,CAACC,QAAQ,CAACD,KAAK,CAACE,GAAG,CAAC,EAAE;MAC3EF,KAAK,CAACG,cAAc,EAAE;IACxB;IAEA,IAAMC,aAAa,GAAG3D,YAAY,CAAC6C,UAAU,aAAVA,UAAU,cAAVA,UAAU,GAAIpC,KAAK,EAAE8C,KAAK,CAACE,GAAG,CAAC;IAElE,IAAIE,aAAa,IAAI,CAACjE,WAAW,CAACiE,aAAa,EAAE7B,QAAQ,CAAC,EAAE;MAC1DY,WAAW,CAACiB,aAAa,CAAC;IAC5B;IACAb,aAAa,CAACa,aAAa,CAAC;EAC9B,CAAC,EACD,CAACd,UAAU,EAAEC,aAAa,EAAEJ,WAAW,EAAEjC,KAAK,EAAEqB,QAAQ,CAAC,CAC1D;EAED,IAAM8B,WAAW,GAAGnE,KAAK,CAAC6D,WAAW,CACnC,UAACO,IAAU,EAAK;IACdnD,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAGT,YAAY,CAAC4D,IAAI,EAAEpD,KAAK,CAA4B,CAAC;EAClE,CAAC,EACD,CAACA,KAAK,EAAEC,QAAQ,CAAC,CAClB;EAED,IAAMoD,WAAW,GAAGrE,KAAK,CAAC6D,WAAW,CACnC,UAACS,GAAS;IAAA,OAAKC,OAAO,CAACvD,KAAK,IAAId,SAAS,CAACoE,GAAG,EAAEtD,KAAK,CAAC,CAAC;EAAA,GACtD,CAACA,KAAK,CAAC,CACR;EAED,oBACE,wCACMgC,KAAK;IACT,GAAG,EAAEvB,UAAW;IAChB,SAAS,EAAEb,UAAU,iBAAqB4D,MAAM,0BAAmBrC,IAAI,EAAG,EAAEW,SAAS;EAAE,iBAEvF,oBAAC,cAAc;IACb,QAAQ,EAAEV,gBAAgB,IAAIC,QAAS;IACvC,QAAQ,EAAEY,WAAY;IACtB,WAAW,EAAEE,YAAa;IAC1B,WAAW,EAAED,YAAa;IAC1B,cAAc,EAAExB,cAAc,IAAIS,IAAI,KAAK,GAAI;IAC/C,SAAS,wBAA6B;IACtC,kBAAkB,EAAEN,kBAAmB;IACvC,kBAAkB,EAAEC,kBAAmB;IACvC,oBAAoB,EAAEC,oBAAqB;IAC3C,mBAAmB,EAAEC,mBAAoB;IACzC,aAAa,EAAES,aAAc;IAC7B,aAAa,EAAEC,aAAc;IAC7B,cAAc,EAAEC,cAAe;IAC/B,cAAc,EAAEC;EAAe,EAC/B,eACF,oBAAC,YAAY;IACX,QAAQ,EAAER,gBAAgB,IAAIC,QAAS;IACvC,KAAK,EAAErB,KAAM;IACb,YAAY,EAAEQ,YAAa;IAC3B,YAAY,EAAE8B,YAAa;IAC3B,QAAQ,EAAE,CAAE;IACZ,cAAYpB,kBAAmB;IAC/B,SAAS,EAAE0B,aAAc;IACzB,WAAW,EAAEO,WAAY;IACzB,WAAW,EAAEE,WAAY;IACzB,mBAAmB,EAAE5D,UAAW;IAChC,iBAAiB,EAAEC,SAAU;IAC7B,aAAa,EAAE6C,aAAc;IAC7B,MAAM,EAAEC,gBAAiB;IACzB,oBAAoB,EAAEvB,oBAAqB;IAC3C,IAAI,EAAEE,IAAK;IACX,QAAQ,EAAEU,QAAS;IACnB,yBAAyB,EAAEE;EAA0B,EACrD,EACDzB,UAAU,IAAIN,KAAK,IAAImB,IAAI,KAAK,GAAG,iBAClC;IAAK,SAAS;EAA2B,gBACvC,oBAAC,YAAY;IACX,KAAK,EAAEnB,KAAM;IACb,QAAQ,EAAEC,QAAS;IACnB,OAAO,EAAEI,OAAQ;IACjB,cAAc,EAAEE,cAAe;IAC/B,oBAAoB,EAAEI,oBAAqB;IAC3C,sBAAsB,EAAEC;EAAuB,EAC/C,CAEL,CACG;AAEV,CAAC;AAAC;EAAA;EAAA;AAAA"}