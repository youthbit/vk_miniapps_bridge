{"version":3,"file":"UsersStack.js","names":["React","classNames","hasReactNode","Footnote","Caption","useId","PathElement","photoSize","direction","props","radius","photoSizes","s","m","l","UsersStack","photos","visibleCount","count","Math","max","length","size","layout","children","className","restProps","cmpId","canShowOthers","CounterTypography","directionClip","photosElements","slice","map","photo","i","id","hrefID","maskID","othersElement","styles"],"sources":["../../../../src/components/UsersStack/UsersStack.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames, hasReactNode } from '@vkontakte/vkjs';\nimport { Footnote } from '../Typography/Footnote/Footnote';\nimport { Caption } from '../Typography/Caption/Caption';\nimport { useId } from '../../hooks/useId';\nimport styles from './UsersStack.module.css';\n\nexport interface UsersStackProps extends React.HTMLAttributes<HTMLDivElement> {\n  /**\n   * Массив ссылок на фотографии\n   */\n  photos?: string[];\n  /**\n   * Размер аватарок\n   */\n  size?: 's' | 'm' | 'l';\n  /**\n   * Вертикальный режим рекомендуется использовать с размером `m`\n   */\n  layout?: 'vertical' | 'horizontal';\n  /**\n   * Количество аватарок, которые будут показаны.\n   * Если в массиве `photos` больше элементов и используется размер `m`, то будет показано количество остальных элементов\n   */\n  visibleCount?: number;\n  /**\n   * Число, которое будет указано в счетчике.\n   * По умолчанию высчитывается по формуле `photos.length - visibleCount`.\n   * Если число больше 99, то счетчик скроется.\n   */\n  count?: number;\n}\n\ninterface PathElementProps extends React.SVGAttributes<SVGElement> {\n  photoSize: number;\n  direction: 'circle' | 'right' | 'left';\n}\n\ntype PhotoSizeType = 16 | 24 | 32;\n\nfunction PathElement({ photoSize, direction, ...props }: PathElementProps) {\n  switch (direction) {\n    case 'circle':\n      const radius = photoSize / 2;\n\n      return <circle cx={radius} cy={radius} r={radius} {...props} />;\n\n    case 'right':\n      switch (photoSize) {\n        case 24:\n          return (\n            <path\n              d=\"M22,18.625A12 12 0 0 1 12 24A12 12 0 0 1 12 0A12 12 0 0 1 22 5.375A12 12 0 0 0 22,18.625\"\n              {...props}\n            />\n          );\n\n        default:\n          return (\n            <path\n              d=\"M30,23.75A16 16 0 0 1 16 32A16 16 0 0 1 16 0A16 16 0 0 1 30 8.25A16 16 0 0 0 30,23.75\"\n              {...props}\n            />\n          );\n      }\n\n    default:\n      switch (photoSize) {\n        case 16:\n          return (\n            <path\n              d=\"M2,13.285A8 8 0 0 0 8 16A8 8 0 0 0 8 0A8 8 0 0 0 2 2.715A8 8 0 0 1 2,13.285\"\n              {...props}\n            />\n          );\n        case 24:\n          return (\n            <path\n              d=\"M2,18.625A12 12 0 0 0 12 24A12 12 0 0 0 12 0A12 12 0 0 0 2 5.375A12 12 0 0 1 2,18.625\"\n              {...props}\n            />\n          );\n\n        default:\n          return (\n            <path\n              d=\"M2,23.75A16 16 0 0 0 16 32A16 16 0 0 0 16 0A16 16 0 0 0 2 8.25A16 16 0 0 1 2,23.75\"\n              {...props}\n            />\n          );\n      }\n  }\n}\n\nconst photoSizes: Record<NonNullable<UsersStackProps['size']>, PhotoSizeType> = {\n  s: 16,\n  m: 24,\n  l: 32,\n};\n\n/**\n * @see https://vkcom.github.io/VKUI/#/UsersStack\n */\nexport const UsersStack = ({\n  photos = [],\n  visibleCount = 3,\n  count = Math.max(0, photos.length - visibleCount),\n  size = 'm',\n  layout = 'horizontal',\n  children,\n  className,\n  ...restProps\n}: UsersStackProps) => {\n  const cmpId = useId();\n\n  const canShowOthers = count > 0 && size !== 's';\n  const CounterTypography = size === 'l' ? Footnote : Caption;\n\n  const photoSize = photoSizes[size];\n  const directionClip = canShowOthers ? 'right' : 'left';\n\n  const photosElements = photos.slice(0, visibleCount).map((photo, i) => {\n    const direction = i === 0 && !canShowOthers ? 'circle' : directionClip;\n\n    const id = `UsersStackDefs${cmpId}${i}`;\n    const hrefID = `#${id}`;\n    const maskID = `UsersStackMask${cmpId}${i}`;\n\n    return (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        className={styles['UsersStack__photo']}\n        key={i}\n        aria-hidden\n      >\n        <defs>\n          <PathElement id={id} direction={direction} photoSize={photoSize} />\n        </defs>\n        <clipPath id={maskID}>\n          <use href={hrefID} />\n        </clipPath>\n        <g clipPath={`url(#${maskID})`}>\n          <use href={hrefID} className={styles['UsersStack__fill']} />\n          <image href={photo} width={photoSize} height={photoSize} />\n          <use href={hrefID} fill=\"none\" stroke=\"rgba(0, 0, 0, 0.08)\" />\n        </g>\n      </svg>\n    );\n  });\n  const othersElement = canShowOthers ? (\n    <CounterTypography\n      caps\n      weight=\"1\"\n      className={classNames(styles['UsersStack__photo'], styles['UsersStack__photo--others'])}\n    >\n      +{count}\n    </CounterTypography>\n  ) : null;\n\n  return (\n    <div\n      {...restProps}\n      className={classNames(\n        styles['UsersStack'],\n        styles[`UsersStack--size-${size}`],\n        styles[`UsersStack--layout-${layout}`],\n        canShowOthers && styles['UsersStack--others'],\n        className,\n      )}\n    >\n      {(photosElements.length > 0 || othersElement) && (\n        <div className={styles['UsersStack__photos']} role=\"presentation\">\n          {photosElements}\n          {othersElement}\n        </div>\n      )}\n      {hasReactNode(children) && (\n        <Footnote className={styles['UsersStack__text']}>{children}</Footnote>\n      )}\n    </div>\n  );\n};\n"],"mappings":"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"}