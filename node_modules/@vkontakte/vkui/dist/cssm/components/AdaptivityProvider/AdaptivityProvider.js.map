{"version":3,"file":"AdaptivityProvider.js","names":["React","hasMouse","_hasPointer","SizeType","ViewWidth","ViewHeight","BREAKPOINTS","useBridgeAdaptivity","AdaptivityContext","AdaptivityProvider","viewWidth","viewHeight","sizeX","sizeY","hasPointer","hasHover","children","bridge","useState","adaptivity","setAdaptivity","useEffect","calculateAdaptivity","type","viewportWidth","viewportHeight","DESKTOP","TABLET","SMALL_TABLET","MOBILE","SMALL_MOBILE","MEDIUM_HEIGHT","MEDIUM","MOBILE_LANDSCAPE_HEIGHT","SMALL","EXTRA_SMALL","COMPACT","REGULAR","undefined"],"sources":["../../../../src/components/AdaptivityProvider/AdaptivityProvider.tsx"],"sourcesContent":["import * as React from 'react';\nimport { hasMouse as _hasPointer } from '@vkontakte/vkjs';\nimport { SizeType, ViewWidth, ViewHeight, BREAKPOINTS } from '../../lib/adaptivity';\nimport { useBridgeAdaptivity, BridgeAdaptivity } from '../../hooks/useBridgeAdaptivity';\nimport { type AdaptivityProps, AdaptivityContext } from './AdaptivityContext';\n\nexport interface AdaptivityProviderProps extends AdaptivityProps {\n  children?: React.ReactNode;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/AdaptivityProvider\n */\nexport const AdaptivityProvider = ({\n  viewWidth,\n  viewHeight,\n  sizeX,\n  sizeY,\n  hasPointer,\n  hasHover,\n  children,\n}: React.PropsWithChildren<AdaptivityProps>) => {\n  const bridge = useBridgeAdaptivity();\n  const [adaptivity, setAdaptivity] = React.useState({\n    viewWidth,\n    viewHeight,\n    sizeX,\n    sizeY,\n    hasPointer,\n    hasHover,\n  });\n\n  React.useEffect(() => {\n    setAdaptivity(\n      calculateAdaptivity(\n        {\n          viewWidth,\n          viewHeight,\n          sizeX,\n          sizeY,\n          hasPointer,\n          hasHover,\n        },\n        bridge,\n      ),\n    );\n  }, [viewWidth, viewHeight, sizeX, sizeY, hasPointer, hasHover, bridge]);\n\n  return <AdaptivityContext.Provider value={adaptivity}>{children}</AdaptivityContext.Provider>;\n};\n\nfunction calculateAdaptivity(\n  { viewWidth, viewHeight, sizeX, sizeY, hasPointer, hasHover }: AdaptivityProps,\n  bridge: BridgeAdaptivity,\n) {\n  if (bridge.type === 'adaptive') {\n    const { viewportWidth, viewportHeight } = bridge;\n\n    if (viewportWidth >= BREAKPOINTS.DESKTOP) {\n      viewWidth = ViewWidth.DESKTOP;\n    } else if (viewportWidth >= BREAKPOINTS.TABLET) {\n      viewWidth = ViewWidth.TABLET;\n    } else if (viewportWidth >= BREAKPOINTS.SMALL_TABLET) {\n      viewWidth = ViewWidth.SMALL_TABLET;\n    } else if (viewportWidth >= BREAKPOINTS.MOBILE) {\n      viewWidth = ViewWidth.MOBILE;\n    } else {\n      viewWidth = ViewWidth.SMALL_MOBILE;\n    }\n\n    if (viewportHeight >= BREAKPOINTS.MEDIUM_HEIGHT) {\n      viewHeight = ViewHeight.MEDIUM;\n    } else if (viewportHeight > BREAKPOINTS.MOBILE_LANDSCAPE_HEIGHT) {\n      viewHeight = ViewHeight.SMALL;\n    } else {\n      viewHeight = ViewHeight.EXTRA_SMALL;\n    }\n\n    if (viewWidth <= ViewWidth.MOBILE) {\n      sizeX = SizeType.COMPACT;\n    } else {\n      sizeX = SizeType.REGULAR;\n    }\n\n    if (\n      (viewWidth >= ViewWidth.SMALL_TABLET && _hasPointer) ||\n      viewHeight <= ViewHeight.EXTRA_SMALL\n    ) {\n      sizeY = SizeType.COMPACT;\n    } else {\n      sizeY = SizeType.REGULAR;\n    }\n  } else if (bridge.type === 'force_mobile' || bridge.type === 'force_mobile_compact') {\n    viewWidth = ViewWidth.MOBILE;\n    sizeX = SizeType.COMPACT;\n\n    if (bridge.type === 'force_mobile_compact') {\n      sizeY = SizeType.COMPACT;\n    } else {\n      sizeY = SizeType.REGULAR;\n    }\n  } else {\n    if (sizeX === undefined && viewWidth !== undefined) {\n      if (viewWidth <= ViewWidth.MOBILE) {\n        sizeX = SizeType.COMPACT;\n      } else {\n        sizeX = SizeType.REGULAR;\n      }\n    }\n    if (sizeY === undefined && viewWidth !== undefined && viewHeight !== undefined) {\n      if (\n        (viewWidth >= ViewWidth.SMALL_TABLET && _hasPointer) ||\n        viewHeight <= ViewHeight.EXTRA_SMALL\n      ) {\n        sizeY = SizeType.COMPACT;\n      } else {\n        sizeY = SizeType.REGULAR;\n      }\n    }\n  }\n\n  return {\n    viewWidth,\n    viewHeight,\n    sizeX,\n    sizeY,\n    hasPointer,\n    hasHover,\n  };\n}\n"],"mappings":"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"}