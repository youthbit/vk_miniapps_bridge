{"version":3,"file":"ViewInfinite.js","names":["React","classNames","transitionEvent","animationEvent","getPlatformClassName","Platform","Touch","withPlatform","withContext","ConfigProviderContext","SplitColContext","AppRootPortal","canUseDOM","withDOM","ScrollContext","NavTransitionProvider","getNavId","warnOnce","swipeBackExcluded","warn","SwipeBackResults","scrollsCache","ViewInfiniteComponent","props","undefined","e","includes","animationName","state","prevPanel","flushTransition","Boolean","isBack","propertyName","target","pickPanel","swipeBackNextPanel","swipeBackResult","fail","onSwipeBackCancel","success","onSwipeBackSuccess","event","window","platform","IOS","swipeBackPrevented","shouldDisableTransitionMotion","configProvider","isWebView","startX","SWIPE_BACK_AREA","innerWidth","browserSwipe","setState","onSwipeBack","animated","swipingBack","history","length","onSwipeBackStart","payload","activePanel","blurActiveElement","prevScrolls","scrolls","scroll","getScroll","y","swipeBackStartX","swipeBackPrevPanel","slice","swipeBackShift","shiftX","speed","duration","visiblePanels","nextPanel","document","Children","toArray","children","id","animationFinishTimeout","clearTimeout","prevProps","prevState","popout","modal","isBackCheck","from","to","firstLayerId","panels","map","panel","find","supported","setTimeout","transitionEndHandler","ANDROID","VKCOM","scrollPosition","prevPanelScrolls","newPanelScrolls","pop","scrollTo","onTransition","waitTransitionFinish","swipingBackTransitionEndHandler","transitionMotionEnabled","splitCol","animate","elem","eventHandler","name","removeEventListener","addEventListener","transitionFinishTimeout","activeElement","blur","panelNodes","panelId","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","_1","nav","className","restProps","hasPopout","hasModal","filter","sort","isPrevPanel","isNextPanel","disableAnimation","onMoveX","onEnd","compensateScroll","isTransitionTarget","scrollList","el","calcPanelSwipeStyles","marginTop","Component","ViewInfinite"],"sources":["../../../src/components/View/ViewInfinite.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { transitionEvent, animationEvent } from '../../lib/supportEvents';\nimport { getPlatformClassName } from '../../helpers/getPlatformClassName';\nimport { Platform } from '../../lib/platform';\nimport { Touch, TouchEvent } from '../Touch/Touch';\nimport { HasPlatform } from '../../types';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport { withContext } from '../../hoc/withContext';\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n} from '../ConfigProvider/ConfigProviderContext';\nimport { SplitColContext, SplitColContextProps } from '../SplitCol/SplitCol';\nimport { AppRootPortal } from '../AppRoot/AppRootPortal';\nimport { canUseDOM, withDOM, DOMProps } from '../../lib/dom';\nimport { ScrollContext, ScrollContextInterface } from '../AppRoot/ScrollContext';\nimport { NavTransitionProvider } from '../NavTransitionContext/NavTransitionContext';\nimport { getNavId, NavIdProps } from '../../lib/getNavId';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { swipeBackExcluded } from './utils';\nimport styles from './View.module.css';\nimport iosStyles from './ViewIOS.module.css';\n\nconst warn = warnOnce('ViewInfinite');\n\nenum SwipeBackResults {\n  fail = 1,\n  success,\n}\n\ninterface Scrolls {\n  [index: string]: Array<number | undefined>;\n}\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls;\n}\n\ntype TransitionEventHandler = (e?: TransitionEvent) => void;\n\nlet scrollsCache: ViewsScrolls = {};\n\nexport type TransitionParams = { from: string | null; to: string | null };\n\nexport interface ViewInfiniteProps\n  extends React.HTMLAttributes<HTMLElement>,\n    HasPlatform,\n    NavIdProps {\n  activePanel: string;\n  popout?: React.ReactNode;\n  modal?: React.ReactNode;\n  onTransition?(params: TransitionParams & { isBack: boolean }): void;\n  /**\n   * callback свайпа назад\n   */\n  onSwipeBack?(): void;\n  /**\n   * callback начала анимации свайпа назад.\n   */\n  onSwipeBackStart?(activePanel: string | null): void | 'prevent';\n  /**\n   * callback завершения анимации отмененного пользователем свайпа\n   */\n  onSwipeBackCancel?(): void;\n  history?: string[];\n  isBackCheck?(params: TransitionParams): boolean;\n  /**\n   * @ignore\n   */\n  splitCol?: SplitColContextProps;\n  /**\n   * @ignore\n   */\n  configProvider?: ConfigProviderContextInterface;\n  /**\n   * @ignore\n   */\n  scroll?: ScrollContextInterface;\n}\n\nexport interface ViewInfiniteState {\n  animated: boolean;\n\n  visiblePanels: Array<string | null>;\n  activePanel: string | null;\n  isBack?: boolean;\n  prevPanel: string | null;\n  nextPanel: string | null;\n\n  swipingBack: boolean;\n  swipeBackPrevented: boolean;\n  swipeBackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string | null;\n  swipeBackPrevPanel: string | null;\n  swipeBackResult: SwipeBackResults | null;\n\n  browserSwipe: boolean;\n}\n\nclass ViewInfiniteComponent extends React.Component<\n  ViewInfiniteProps & DOMProps,\n  ViewInfiniteState\n> {\n  private static readonly SWIPE_BACK_AREA = 70;\n\n  constructor(props: ViewInfiniteProps) {\n    super(props);\n\n    this.state = {\n      animated: false,\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipeBackPrevented: false,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n\n      browserSwipe: false,\n    };\n  }\n\n  static defaultProps: Partial<ViewInfiniteProps> = {\n    history: [],\n  };\n\n  private scrolls = scrollsCache[getNavId(this.props, warn) as string] || {};\n  private transitionFinishTimeout: ReturnType<typeof setTimeout> | undefined = undefined;\n  private animationFinishTimeout: ReturnType<typeof setTimeout> | undefined = undefined;\n\n  get document() {\n    return this.props.document;\n  }\n\n  get window() {\n    return this.props.window;\n  }\n\n  get panels() {\n    return React.Children.toArray(this.props.children) as React.ReactElement[];\n  }\n\n  panelNodes: { [id: string]: HTMLDivElement | null } = {};\n\n  componentWillUnmount() {\n    const id = getNavId(this.props);\n    if (id) {\n      scrollsCache[id] = this.scrolls;\n    }\n    if (this.animationFinishTimeout) {\n      clearTimeout(this.animationFinishTimeout);\n    }\n  }\n\n  componentDidUpdate(prevProps: ViewInfiniteProps, prevState: ViewInfiniteState) {\n    this.props.popout && !prevProps.popout && this.blurActiveElement();\n    this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      !prevState.swipingBack &&\n      !prevState.browserSwipe\n    ) {\n      let isBack = false;\n\n      if (this.props.isBackCheck) {\n        isBack = this.props.isBackCheck({\n          from: prevProps.activePanel,\n          to: this.props.activePanel,\n        });\n      } else {\n        const firstLayerId = this.panels\n          .map((panel) => getNavId(panel.props, warn))\n          .find((id) => id === prevProps.activePanel || id === this.props.activePanel);\n        isBack = firstLayerId === this.props.activePanel;\n      }\n\n      this.blurActiveElement();\n\n      const prevScrolls = this.scrolls[prevProps.activePanel] || [];\n      const scrolls = {\n        ...this.scrolls,\n        [prevProps.activePanel]: [...prevScrolls, this.props.scroll?.getScroll().y],\n      };\n      this.scrolls = scrolls;\n\n      if (this.shouldDisableTransitionMotion()) {\n        this.flushTransition(prevProps.activePanel, isBack);\n      } else {\n        this.setState({\n          visiblePanels: [prevProps.activePanel, this.props.activePanel],\n          prevPanel: prevProps.activePanel,\n          nextPanel: this.props.activePanel,\n          activePanel: null,\n          animated: true,\n          isBack,\n        });\n\n        // Фолбек анимации перехода\n        if (!animationEvent.supported) {\n          if (this.animationFinishTimeout) {\n            clearTimeout(this.animationFinishTimeout);\n          }\n          this.animationFinishTimeout = setTimeout(\n            this.transitionEndHandler,\n            this.props.platform === Platform.ANDROID || this.props.platform === Platform.VKCOM\n              ? 300\n              : 600,\n          );\n        }\n      }\n    }\n\n    // Закончилась анимация свайпа назад\n    if (prevProps.activePanel !== this.props.activePanel && prevState.swipingBack) {\n      const nextPanel = this.state.swipeBackNextPanel;\n      const prevPanel = this.state.swipeBackPrevPanel;\n      let scrollPosition: undefined | number = undefined;\n\n      this.scrolls = {\n        ...this.scrolls,\n      };\n\n      if (prevPanel !== null) {\n        const prevPanelScrolls = [...(this.scrolls[prevPanel] || [])].slice(0, -1);\n        this.scrolls[prevPanel] = prevPanelScrolls;\n      }\n      if (nextPanel !== null) {\n        const newPanelScrolls = [...(this.scrolls[nextPanel] || [])];\n        scrollPosition = newPanelScrolls.pop();\n        this.scrolls[nextPanel] = newPanelScrolls;\n      }\n\n      this.setState(\n        {\n          swipeBackPrevPanel: null,\n          swipeBackNextPanel: null,\n          swipingBack: false,\n          swipeBackResult: null,\n          swipeBackStartX: 0,\n          swipeBackShift: 0,\n          activePanel: nextPanel,\n          visiblePanels: [nextPanel],\n        },\n        () => {\n          this.props.scroll?.scrollTo(0, scrollPosition);\n          prevProps.onTransition &&\n            prevProps.onTransition({\n              isBack: true,\n              from: prevPanel,\n              to: nextPanel,\n            });\n        },\n      );\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n      this.waitTransitionFinish(\n        this.pickPanel(this.state.swipeBackNextPanel),\n        this.swipingBackTransitionEndHandler,\n      );\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (\n      prevState.swipeBackResult === SwipeBackResults.fail &&\n      !this.state.swipeBackResult &&\n      this.state.activePanel !== null\n    ) {\n      const newPanelScrolls = [...(this.scrolls[this.state.activePanel] || [])];\n      const scrollPosition = newPanelScrolls.pop();\n      this.scrolls = {\n        ...this.scrolls,\n        [this.state.activePanel]: newPanelScrolls,\n      };\n\n      this.props.scroll?.scrollTo(0, scrollPosition);\n    }\n\n    // Закончился Safari свайп\n    if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel,\n      });\n    }\n  }\n\n  shouldDisableTransitionMotion(): boolean {\n    return (\n      this.props.configProvider?.transitionMotionEnabled === false ||\n      !this.props.splitCol?.animate ||\n      this.props.platform === Platform.VKCOM\n    );\n  }\n\n  waitTransitionFinish(\n    elem: HTMLElement | null | undefined,\n    eventHandler: TransitionEventHandler,\n  ): void {\n    if (transitionEvent.supported && transitionEvent.name && elem) {\n      elem.removeEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener,\n      );\n      elem.addEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener,\n      );\n    } else {\n      if (this.transitionFinishTimeout) {\n        clearTimeout(this.transitionFinishTimeout);\n      }\n\n      this.transitionFinishTimeout = setTimeout(\n        eventHandler,\n        this.props.platform === Platform.ANDROID || this.props.platform === Platform.VKCOM\n          ? 300\n          : 600,\n      );\n    }\n  }\n\n  blurActiveElement(): void {\n    if (typeof this.window !== 'undefined' && this.document?.activeElement) {\n      (this.document.activeElement as HTMLElement).blur();\n    }\n  }\n\n  pickPanel(id: string | null) {\n    if (id === null) {\n      return undefined;\n    }\n    return this.panelNodes[id];\n  }\n\n  flushTransition(prevPanel: string, isBack: boolean) {\n    const activePanel = this.props.activePanel;\n\n    const prevPanelScrolls = [...(this.scrolls[prevPanel] || [])].slice(0, -1);\n    const newPanelScrolls = [...(this.scrolls[activePanel] || [])];\n    const scrollPosition = isBack ? newPanelScrolls.pop() : 0;\n    if (isBack) {\n      this.scrolls = {\n        ...this.scrolls,\n        [prevPanel]: prevPanelScrolls,\n        [activePanel]: newPanelScrolls,\n      };\n    }\n\n    this.setState(\n      {\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel: activePanel,\n        animated: false,\n        isBack: undefined,\n      },\n      () => {\n        this.props.scroll?.scrollTo(0, isBack ? scrollPosition : 0);\n        this.props.onTransition &&\n          this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      },\n    );\n  }\n\n  transitionEndHandler = (e?: React.AnimationEvent): void => {\n    if (\n      (!e ||\n        [\n          'vkui-animation-ios-next-forward',\n          'vkui-animation-ios-prev-back',\n          'vkui-animation-view-next-forward',\n          'vkui-animation-view-prev-back',\n        ].includes(e.animationName)) &&\n      this.state.prevPanel !== null\n    ) {\n      this.flushTransition(this.state.prevPanel, Boolean(this.state.isBack));\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e?: TransitionEvent): void => {\n    // indexOf because of vendor prefixes in old browsers\n    if (\n      !e ||\n      (e.propertyName.includes('transform') &&\n        e.target === this.pickPanel(this.state.swipeBackNextPanel))\n    ) {\n      switch (this.state.swipeBackResult) {\n        case SwipeBackResults.fail:\n          this.onSwipeBackCancel();\n          break;\n        case SwipeBackResults.success:\n          this.onSwipeBackSuccess();\n      }\n    }\n  };\n\n  onSwipeBackSuccess(): void {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel(): void {\n    this.props.onSwipeBackCancel && this.props.onSwipeBackCancel();\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipeBackResult: null,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n    });\n  }\n\n  onMoveX = (event: TouchEvent): void => {\n    if (\n      !this.window ||\n      this.props.platform !== Platform.IOS ||\n      this.state.swipeBackPrevented ||\n      swipeBackExcluded(event) ||\n      this.shouldDisableTransitionMotion()\n    ) {\n      return;\n    }\n\n    if (!this.props.configProvider?.isWebView) {\n      if (\n        (event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA ||\n          event.startX >= this.window.innerWidth - ViewInfiniteComponent.SWIPE_BACK_AREA) &&\n        !this.state.browserSwipe\n      ) {\n        this.setState({ browserSwipe: true });\n      }\n\n      return;\n    }\n\n    if (\n      !this.props.onSwipeBack ||\n      (this.state.animated && event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA)\n    ) {\n      return;\n    }\n\n    if (\n      !this.state.swipingBack &&\n      event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA &&\n      this.props.history &&\n      this.props.history.length > 1\n    ) {\n      if (this.props.onSwipeBackStart) {\n        const payload = this.props.onSwipeBackStart(this.state.activePanel);\n        if (payload === 'prevent') {\n          this.setState({ swipeBackPrevented: true });\n          return;\n        }\n      }\n\n      if (this.state.activePanel !== null) {\n        // Note: вызываем закрытие клавиатуры. В iOS это нативное поведение при свайпе.\n        this.blurActiveElement();\n        const prevScrolls = this.scrolls[this.state.activePanel] || [];\n        this.scrolls = {\n          ...this.scrolls,\n          [this.state.activePanel]: [...prevScrolls, this.props.scroll?.getScroll().y],\n        };\n      }\n\n      this.setState({\n        swipingBack: true,\n        swipeBackStartX: event.startX,\n        swipeBackPrevPanel: this.state.activePanel,\n        swipeBackNextPanel: this.props.history.slice(-2)[0],\n      });\n    }\n\n    if (this.state.swipingBack) {\n      let swipeBackShift;\n      if (event.shiftX < 0) {\n        swipeBackShift = 0;\n      } else if (event.shiftX > this.window.innerWidth - this.state.swipeBackStartX) {\n        swipeBackShift = this.window.innerWidth;\n      } else {\n        swipeBackShift = event.shiftX;\n      }\n      this.setState({ swipeBackShift });\n    }\n  };\n\n  onEnd = (event: TouchEvent): void => {\n    if (this.state.swipingBack && this.window) {\n      const speed = (this.state.swipeBackShift / event.duration) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= this.window.innerWidth) {\n        this.onSwipeBackSuccess();\n      } else if (\n        speed > 250 ||\n        this.state.swipeBackStartX + this.state.swipeBackShift > this.window.innerWidth / 2\n      ) {\n        this.setState({ swipeBackResult: SwipeBackResults.success });\n      } else {\n        this.setState({ swipeBackResult: SwipeBackResults.fail });\n      }\n    }\n    if (this.state.swipeBackPrevented) {\n      this.setState({ swipeBackPrevented: false });\n    }\n  };\n\n  calcPanelSwipeStyles(panelId: string | undefined): React.CSSProperties {\n    if (!canUseDOM || !this.window) {\n      return {};\n    }\n\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if ((!isPrev && !isNext) || this.state.swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${\n      -50 + (this.state.swipeBackShift * 100) / this.window.innerWidth / 2\n    }%`;\n    let prevPanelShadow =\n      (0.3 * (this.window.innerWidth - this.state.swipeBackShift)) / this.window.innerWidth;\n\n    if (this.state.swipeBackResult) {\n      return isPrev ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` } : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`,\n      };\n    }\n\n    return {};\n  }\n\n  render() {\n    const {\n      popout,\n      modal,\n      platform,\n      activePanel: _1,\n      splitCol,\n      configProvider,\n      history,\n      id,\n      nav,\n      onTransition,\n      onSwipeBack,\n      onSwipeBackStart,\n      onSwipeBackCancel,\n      window,\n      document,\n      scroll,\n      isBackCheck,\n      className,\n      ...restProps\n    } = this.props;\n    const {\n      prevPanel,\n      nextPanel,\n      activePanel,\n      isBack,\n      animated,\n      swipeBackPrevPanel,\n      swipeBackNextPanel,\n      swipeBackResult,\n      swipingBack,\n    } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels\n      .filter((panel) => {\n        const panelId = getNavId(panel.props, warn);\n\n        return (\n          (panelId !== undefined && this.state.visiblePanels.includes(panelId)) ||\n          panelId === swipeBackPrevPanel ||\n          panelId === swipeBackNextPanel\n        );\n      })\n      .sort((panel) => {\n        const panelId = getNavId(panel.props, warn);\n        const isPrevPanel = panelId === prevPanel || panelId === swipeBackPrevPanel;\n        const isNextPanel = panelId === nextPanel || panelId === swipeBackNextPanel;\n\n        if (isNextPanel) {\n          return swipingBack || this.state.isBack ? -1 : 1;\n        }\n\n        if (isPrevPanel) {\n          return swipingBack || this.state.isBack ? 1 : -1;\n        }\n\n        return 0;\n      });\n\n    const disableAnimation = this.shouldDisableTransitionMotion();\n\n    return (\n      <Touch\n        Component=\"section\"\n        {...restProps}\n        className={classNames(\n          styles['View'],\n          getPlatformClassName(styles['View'], platform),\n          !disableAnimation && this.state.animated && styles['View--animated'],\n          !disableAnimation && this.state.swipingBack && styles['View--swiping-back'],\n          disableAnimation && styles['View--no-motion'],\n          className,\n        )}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        <div className={styles['View__panels']}>\n          {panels.map((panel: React.ReactElement) => {\n            const panelId = getNavId(panel.props, warn);\n            const isPrev = panelId === prevPanel || panelId === swipeBackPrevPanel;\n            const compensateScroll =\n              isPrev || panelId === swipeBackNextPanel || (panelId === nextPanel && isBack);\n            const isTransitionTarget = animated && panelId === (isBack ? prevPanel : nextPanel);\n            const scrollList = (panelId && this.scrolls[panelId]) || [];\n            const scroll = scrollList[scrollList.length - 1] || 0;\n\n            return (\n              <div\n                className={classNames(\n                  styles['View__panel'],\n                  panelId === activePanel && iosStyles['View__panel--active'],\n                  panelId === prevPanel && styles['View__panel--prev'],\n                  panelId === nextPanel && styles['View__panel--next'],\n                  panelId === swipeBackPrevPanel && iosStyles['View__panel--swipe-back-prev'],\n                  panelId === swipeBackNextPanel && iosStyles['View__panel--swipe-back-next'],\n                  swipeBackResult === SwipeBackResults.success &&\n                    iosStyles['View__panel--swipe-back-success'],\n                  swipeBackResult === SwipeBackResults.fail &&\n                    iosStyles['View__panel--swipe-back-failed'],\n                )}\n                onAnimationEnd={isTransitionTarget ? this.transitionEndHandler : undefined}\n                ref={(el) => panelId !== undefined && (this.panelNodes[panelId] = el)}\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div\n                  className={styles['View__panel-in']}\n                  style={{ marginTop: compensateScroll ? -scroll : undefined }}\n                >\n                  <NavTransitionProvider\n                    entering={panelId === nextPanel || panelId === swipeBackNextPanel}\n                  >\n                    {panel}\n                  </NavTransitionProvider>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        <AppRootPortal>\n          {hasPopout && <div className={styles['View__popout']}>{popout}</div>}\n          {hasModal && <div className={styles['View__modal']}>{modal}</div>}\n        </AppRootPortal>\n      </Touch>\n    );\n  }\n}\n\nexport const ViewInfinite = withContext(\n  withContext(\n    withContext(\n      withPlatform(withDOM<ViewInfiniteProps>(ViewInfiniteComponent)),\n      SplitColContext,\n      'splitCol',\n    ),\n    ConfigProviderContext,\n    'configProvider',\n  ),\n  ScrollContext,\n  'scroll',\n);\n"],"mappings":"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"}