{"version":3,"file":"ViewInfinite.js","names":["warn","warnOnce","SwipeBackResults","scrollsCache","ViewInfiniteComponent","props","getNavId","undefined","e","includes","animationName","state","prevPanel","flushTransition","Boolean","isBack","propertyName","target","pickPanel","swipeBackNextPanel","swipeBackResult","fail","onSwipeBackCancel","success","onSwipeBackSuccess","event","window","platform","Platform","IOS","swipeBackPrevented","swipeBackExcluded","shouldDisableTransitionMotion","configProvider","isWebView","startX","SWIPE_BACK_AREA","innerWidth","browserSwipe","setState","onSwipeBack","animated","swipingBack","history","length","onSwipeBackStart","payload","activePanel","blurActiveElement","prevScrolls","scrolls","scroll","getScroll","y","swipeBackStartX","swipeBackPrevPanel","slice","swipeBackShift","shiftX","speed","duration","visiblePanels","nextPanel","document","React","Children","toArray","children","id","animationFinishTimeout","clearTimeout","prevProps","prevState","popout","modal","isBackCheck","from","to","firstLayerId","panels","map","panel","find","animationEvent","supported","setTimeout","transitionEndHandler","ANDROID","VKCOM","scrollPosition","prevPanelScrolls","newPanelScrolls","pop","scrollTo","onTransition","waitTransitionFinish","swipingBackTransitionEndHandler","transitionMotionEnabled","splitCol","animate","elem","eventHandler","transitionEvent","name","removeEventListener","addEventListener","transitionFinishTimeout","activeElement","blur","panelNodes","panelId","canUseDOM","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","_1","nav","className","restProps","hasPopout","hasModal","filter","sort","isPrevPanel","isNextPanel","disableAnimation","classNames","getPlatformClassName","onMoveX","onEnd","compensateScroll","isTransitionTarget","scrollList","el","calcPanelSwipeStyles","marginTop","Component","ViewInfinite","withContext","withPlatform","withDOM","SplitColContext","ConfigProviderContext","ScrollContext"],"sources":["../../../../src/components/View/ViewInfinite.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { transitionEvent, animationEvent } from '../../lib/supportEvents';\nimport { getPlatformClassName } from '../../helpers/getPlatformClassName';\nimport { Platform } from '../../lib/platform';\nimport { Touch, TouchEvent } from '../Touch/Touch';\nimport { HasPlatform } from '../../types';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport { withContext } from '../../hoc/withContext';\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n} from '../ConfigProvider/ConfigProviderContext';\nimport { SplitColContext, SplitColContextProps } from '../SplitCol/SplitCol';\nimport { AppRootPortal } from '../AppRoot/AppRootPortal';\nimport { canUseDOM, withDOM, DOMProps } from '../../lib/dom';\nimport { ScrollContext, ScrollContextInterface } from '../AppRoot/ScrollContext';\nimport { NavTransitionProvider } from '../NavTransitionContext/NavTransitionContext';\nimport { getNavId, NavIdProps } from '../../lib/getNavId';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { swipeBackExcluded } from './utils';\nimport styles from './View.module.css';\nimport iosStyles from './ViewIOS.module.css';\n\nconst warn = warnOnce('ViewInfinite');\n\nenum SwipeBackResults {\n  fail = 1,\n  success,\n}\n\ninterface Scrolls {\n  [index: string]: Array<number | undefined>;\n}\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls;\n}\n\ntype TransitionEventHandler = (e?: TransitionEvent) => void;\n\nlet scrollsCache: ViewsScrolls = {};\n\nexport type TransitionParams = { from: string | null; to: string | null };\n\nexport interface ViewInfiniteProps\n  extends React.HTMLAttributes<HTMLElement>,\n    HasPlatform,\n    NavIdProps {\n  activePanel: string;\n  popout?: React.ReactNode;\n  modal?: React.ReactNode;\n  onTransition?(params: TransitionParams & { isBack: boolean }): void;\n  /**\n   * callback свайпа назад\n   */\n  onSwipeBack?(): void;\n  /**\n   * callback начала анимации свайпа назад.\n   */\n  onSwipeBackStart?(activePanel: string | null): void | 'prevent';\n  /**\n   * callback завершения анимации отмененного пользователем свайпа\n   */\n  onSwipeBackCancel?(): void;\n  history?: string[];\n  isBackCheck?(params: TransitionParams): boolean;\n  /**\n   * @ignore\n   */\n  splitCol?: SplitColContextProps;\n  /**\n   * @ignore\n   */\n  configProvider?: ConfigProviderContextInterface;\n  /**\n   * @ignore\n   */\n  scroll?: ScrollContextInterface;\n}\n\nexport interface ViewInfiniteState {\n  animated: boolean;\n\n  visiblePanels: Array<string | null>;\n  activePanel: string | null;\n  isBack?: boolean;\n  prevPanel: string | null;\n  nextPanel: string | null;\n\n  swipingBack: boolean;\n  swipeBackPrevented: boolean;\n  swipeBackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string | null;\n  swipeBackPrevPanel: string | null;\n  swipeBackResult: SwipeBackResults | null;\n\n  browserSwipe: boolean;\n}\n\nclass ViewInfiniteComponent extends React.Component<\n  ViewInfiniteProps & DOMProps,\n  ViewInfiniteState\n> {\n  private static readonly SWIPE_BACK_AREA = 70;\n\n  constructor(props: ViewInfiniteProps) {\n    super(props);\n\n    this.state = {\n      animated: false,\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipeBackPrevented: false,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n\n      browserSwipe: false,\n    };\n  }\n\n  static defaultProps: Partial<ViewInfiniteProps> = {\n    history: [],\n  };\n\n  private scrolls = scrollsCache[getNavId(this.props, warn) as string] || {};\n  private transitionFinishTimeout: ReturnType<typeof setTimeout> | undefined = undefined;\n  private animationFinishTimeout: ReturnType<typeof setTimeout> | undefined = undefined;\n\n  get document() {\n    return this.props.document;\n  }\n\n  get window() {\n    return this.props.window;\n  }\n\n  get panels() {\n    return React.Children.toArray(this.props.children) as React.ReactElement[];\n  }\n\n  panelNodes: { [id: string]: HTMLDivElement | null } = {};\n\n  componentWillUnmount() {\n    const id = getNavId(this.props);\n    if (id) {\n      scrollsCache[id] = this.scrolls;\n    }\n    if (this.animationFinishTimeout) {\n      clearTimeout(this.animationFinishTimeout);\n    }\n  }\n\n  componentDidUpdate(prevProps: ViewInfiniteProps, prevState: ViewInfiniteState) {\n    this.props.popout && !prevProps.popout && this.blurActiveElement();\n    this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      !prevState.swipingBack &&\n      !prevState.browserSwipe\n    ) {\n      let isBack = false;\n\n      if (this.props.isBackCheck) {\n        isBack = this.props.isBackCheck({\n          from: prevProps.activePanel,\n          to: this.props.activePanel,\n        });\n      } else {\n        const firstLayerId = this.panels\n          .map((panel) => getNavId(panel.props, warn))\n          .find((id) => id === prevProps.activePanel || id === this.props.activePanel);\n        isBack = firstLayerId === this.props.activePanel;\n      }\n\n      this.blurActiveElement();\n\n      const prevScrolls = this.scrolls[prevProps.activePanel] || [];\n      const scrolls = {\n        ...this.scrolls,\n        [prevProps.activePanel]: [...prevScrolls, this.props.scroll?.getScroll().y],\n      };\n      this.scrolls = scrolls;\n\n      if (this.shouldDisableTransitionMotion()) {\n        this.flushTransition(prevProps.activePanel, isBack);\n      } else {\n        this.setState({\n          visiblePanels: [prevProps.activePanel, this.props.activePanel],\n          prevPanel: prevProps.activePanel,\n          nextPanel: this.props.activePanel,\n          activePanel: null,\n          animated: true,\n          isBack,\n        });\n\n        // Фолбек анимации перехода\n        if (!animationEvent.supported) {\n          if (this.animationFinishTimeout) {\n            clearTimeout(this.animationFinishTimeout);\n          }\n          this.animationFinishTimeout = setTimeout(\n            this.transitionEndHandler,\n            this.props.platform === Platform.ANDROID || this.props.platform === Platform.VKCOM\n              ? 300\n              : 600,\n          );\n        }\n      }\n    }\n\n    // Закончилась анимация свайпа назад\n    if (prevProps.activePanel !== this.props.activePanel && prevState.swipingBack) {\n      const nextPanel = this.state.swipeBackNextPanel;\n      const prevPanel = this.state.swipeBackPrevPanel;\n      let scrollPosition: undefined | number = undefined;\n\n      this.scrolls = {\n        ...this.scrolls,\n      };\n\n      if (prevPanel !== null) {\n        const prevPanelScrolls = [...(this.scrolls[prevPanel] || [])].slice(0, -1);\n        this.scrolls[prevPanel] = prevPanelScrolls;\n      }\n      if (nextPanel !== null) {\n        const newPanelScrolls = [...(this.scrolls[nextPanel] || [])];\n        scrollPosition = newPanelScrolls.pop();\n        this.scrolls[nextPanel] = newPanelScrolls;\n      }\n\n      this.setState(\n        {\n          swipeBackPrevPanel: null,\n          swipeBackNextPanel: null,\n          swipingBack: false,\n          swipeBackResult: null,\n          swipeBackStartX: 0,\n          swipeBackShift: 0,\n          activePanel: nextPanel,\n          visiblePanels: [nextPanel],\n        },\n        () => {\n          this.props.scroll?.scrollTo(0, scrollPosition);\n          prevProps.onTransition &&\n            prevProps.onTransition({\n              isBack: true,\n              from: prevPanel,\n              to: nextPanel,\n            });\n        },\n      );\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n      this.waitTransitionFinish(\n        this.pickPanel(this.state.swipeBackNextPanel),\n        this.swipingBackTransitionEndHandler,\n      );\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (\n      prevState.swipeBackResult === SwipeBackResults.fail &&\n      !this.state.swipeBackResult &&\n      this.state.activePanel !== null\n    ) {\n      const newPanelScrolls = [...(this.scrolls[this.state.activePanel] || [])];\n      const scrollPosition = newPanelScrolls.pop();\n      this.scrolls = {\n        ...this.scrolls,\n        [this.state.activePanel]: newPanelScrolls,\n      };\n\n      this.props.scroll?.scrollTo(0, scrollPosition);\n    }\n\n    // Закончился Safari свайп\n    if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel,\n      });\n    }\n  }\n\n  shouldDisableTransitionMotion(): boolean {\n    return (\n      this.props.configProvider?.transitionMotionEnabled === false ||\n      !this.props.splitCol?.animate ||\n      this.props.platform === Platform.VKCOM\n    );\n  }\n\n  waitTransitionFinish(\n    elem: HTMLElement | null | undefined,\n    eventHandler: TransitionEventHandler,\n  ): void {\n    if (transitionEvent.supported && transitionEvent.name && elem) {\n      elem.removeEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener,\n      );\n      elem.addEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener,\n      );\n    } else {\n      if (this.transitionFinishTimeout) {\n        clearTimeout(this.transitionFinishTimeout);\n      }\n\n      this.transitionFinishTimeout = setTimeout(\n        eventHandler,\n        this.props.platform === Platform.ANDROID || this.props.platform === Platform.VKCOM\n          ? 300\n          : 600,\n      );\n    }\n  }\n\n  blurActiveElement(): void {\n    if (typeof this.window !== 'undefined' && this.document?.activeElement) {\n      (this.document.activeElement as HTMLElement).blur();\n    }\n  }\n\n  pickPanel(id: string | null) {\n    if (id === null) {\n      return undefined;\n    }\n    return this.panelNodes[id];\n  }\n\n  flushTransition(prevPanel: string, isBack: boolean) {\n    const activePanel = this.props.activePanel;\n\n    const prevPanelScrolls = [...(this.scrolls[prevPanel] || [])].slice(0, -1);\n    const newPanelScrolls = [...(this.scrolls[activePanel] || [])];\n    const scrollPosition = isBack ? newPanelScrolls.pop() : 0;\n    if (isBack) {\n      this.scrolls = {\n        ...this.scrolls,\n        [prevPanel]: prevPanelScrolls,\n        [activePanel]: newPanelScrolls,\n      };\n    }\n\n    this.setState(\n      {\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel: activePanel,\n        animated: false,\n        isBack: undefined,\n      },\n      () => {\n        this.props.scroll?.scrollTo(0, isBack ? scrollPosition : 0);\n        this.props.onTransition &&\n          this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      },\n    );\n  }\n\n  transitionEndHandler = (e?: React.AnimationEvent): void => {\n    if (\n      (!e ||\n        [\n          'vkui-animation-ios-next-forward',\n          'vkui-animation-ios-prev-back',\n          'vkui-animation-view-next-forward',\n          'vkui-animation-view-prev-back',\n        ].includes(e.animationName)) &&\n      this.state.prevPanel !== null\n    ) {\n      this.flushTransition(this.state.prevPanel, Boolean(this.state.isBack));\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e?: TransitionEvent): void => {\n    // indexOf because of vendor prefixes in old browsers\n    if (\n      !e ||\n      (e.propertyName.includes('transform') &&\n        e.target === this.pickPanel(this.state.swipeBackNextPanel))\n    ) {\n      switch (this.state.swipeBackResult) {\n        case SwipeBackResults.fail:\n          this.onSwipeBackCancel();\n          break;\n        case SwipeBackResults.success:\n          this.onSwipeBackSuccess();\n      }\n    }\n  };\n\n  onSwipeBackSuccess(): void {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel(): void {\n    this.props.onSwipeBackCancel && this.props.onSwipeBackCancel();\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipeBackResult: null,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n    });\n  }\n\n  onMoveX = (event: TouchEvent): void => {\n    if (\n      !this.window ||\n      this.props.platform !== Platform.IOS ||\n      this.state.swipeBackPrevented ||\n      swipeBackExcluded(event) ||\n      this.shouldDisableTransitionMotion()\n    ) {\n      return;\n    }\n\n    if (!this.props.configProvider?.isWebView) {\n      if (\n        (event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA ||\n          event.startX >= this.window.innerWidth - ViewInfiniteComponent.SWIPE_BACK_AREA) &&\n        !this.state.browserSwipe\n      ) {\n        this.setState({ browserSwipe: true });\n      }\n\n      return;\n    }\n\n    if (\n      !this.props.onSwipeBack ||\n      (this.state.animated && event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA)\n    ) {\n      return;\n    }\n\n    if (\n      !this.state.swipingBack &&\n      event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA &&\n      this.props.history &&\n      this.props.history.length > 1\n    ) {\n      if (this.props.onSwipeBackStart) {\n        const payload = this.props.onSwipeBackStart(this.state.activePanel);\n        if (payload === 'prevent') {\n          this.setState({ swipeBackPrevented: true });\n          return;\n        }\n      }\n\n      if (this.state.activePanel !== null) {\n        // Note: вызываем закрытие клавиатуры. В iOS это нативное поведение при свайпе.\n        this.blurActiveElement();\n        const prevScrolls = this.scrolls[this.state.activePanel] || [];\n        this.scrolls = {\n          ...this.scrolls,\n          [this.state.activePanel]: [...prevScrolls, this.props.scroll?.getScroll().y],\n        };\n      }\n\n      this.setState({\n        swipingBack: true,\n        swipeBackStartX: event.startX,\n        swipeBackPrevPanel: this.state.activePanel,\n        swipeBackNextPanel: this.props.history.slice(-2)[0],\n      });\n    }\n\n    if (this.state.swipingBack) {\n      let swipeBackShift;\n      if (event.shiftX < 0) {\n        swipeBackShift = 0;\n      } else if (event.shiftX > this.window.innerWidth - this.state.swipeBackStartX) {\n        swipeBackShift = this.window.innerWidth;\n      } else {\n        swipeBackShift = event.shiftX;\n      }\n      this.setState({ swipeBackShift });\n    }\n  };\n\n  onEnd = (event: TouchEvent): void => {\n    if (this.state.swipingBack && this.window) {\n      const speed = (this.state.swipeBackShift / event.duration) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= this.window.innerWidth) {\n        this.onSwipeBackSuccess();\n      } else if (\n        speed > 250 ||\n        this.state.swipeBackStartX + this.state.swipeBackShift > this.window.innerWidth / 2\n      ) {\n        this.setState({ swipeBackResult: SwipeBackResults.success });\n      } else {\n        this.setState({ swipeBackResult: SwipeBackResults.fail });\n      }\n    }\n    if (this.state.swipeBackPrevented) {\n      this.setState({ swipeBackPrevented: false });\n    }\n  };\n\n  calcPanelSwipeStyles(panelId: string | undefined): React.CSSProperties {\n    if (!canUseDOM || !this.window) {\n      return {};\n    }\n\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if ((!isPrev && !isNext) || this.state.swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${\n      -50 + (this.state.swipeBackShift * 100) / this.window.innerWidth / 2\n    }%`;\n    let prevPanelShadow =\n      (0.3 * (this.window.innerWidth - this.state.swipeBackShift)) / this.window.innerWidth;\n\n    if (this.state.swipeBackResult) {\n      return isPrev ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` } : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`,\n      };\n    }\n\n    return {};\n  }\n\n  render() {\n    const {\n      popout,\n      modal,\n      platform,\n      activePanel: _1,\n      splitCol,\n      configProvider,\n      history,\n      id,\n      nav,\n      onTransition,\n      onSwipeBack,\n      onSwipeBackStart,\n      onSwipeBackCancel,\n      window,\n      document,\n      scroll,\n      isBackCheck,\n      className,\n      ...restProps\n    } = this.props;\n    const {\n      prevPanel,\n      nextPanel,\n      activePanel,\n      isBack,\n      animated,\n      swipeBackPrevPanel,\n      swipeBackNextPanel,\n      swipeBackResult,\n      swipingBack,\n    } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels\n      .filter((panel) => {\n        const panelId = getNavId(panel.props, warn);\n\n        return (\n          (panelId !== undefined && this.state.visiblePanels.includes(panelId)) ||\n          panelId === swipeBackPrevPanel ||\n          panelId === swipeBackNextPanel\n        );\n      })\n      .sort((panel) => {\n        const panelId = getNavId(panel.props, warn);\n        const isPrevPanel = panelId === prevPanel || panelId === swipeBackPrevPanel;\n        const isNextPanel = panelId === nextPanel || panelId === swipeBackNextPanel;\n\n        if (isNextPanel) {\n          return swipingBack || this.state.isBack ? -1 : 1;\n        }\n\n        if (isPrevPanel) {\n          return swipingBack || this.state.isBack ? 1 : -1;\n        }\n\n        return 0;\n      });\n\n    const disableAnimation = this.shouldDisableTransitionMotion();\n\n    return (\n      <Touch\n        Component=\"section\"\n        {...restProps}\n        className={classNames(\n          styles['View'],\n          getPlatformClassName(styles['View'], platform),\n          !disableAnimation && this.state.animated && styles['View--animated'],\n          !disableAnimation && this.state.swipingBack && styles['View--swiping-back'],\n          disableAnimation && styles['View--no-motion'],\n          className,\n        )}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        <div className={styles['View__panels']}>\n          {panels.map((panel: React.ReactElement) => {\n            const panelId = getNavId(panel.props, warn);\n            const isPrev = panelId === prevPanel || panelId === swipeBackPrevPanel;\n            const compensateScroll =\n              isPrev || panelId === swipeBackNextPanel || (panelId === nextPanel && isBack);\n            const isTransitionTarget = animated && panelId === (isBack ? prevPanel : nextPanel);\n            const scrollList = (panelId && this.scrolls[panelId]) || [];\n            const scroll = scrollList[scrollList.length - 1] || 0;\n\n            return (\n              <div\n                className={classNames(\n                  styles['View__panel'],\n                  panelId === activePanel && iosStyles['View__panel--active'],\n                  panelId === prevPanel && styles['View__panel--prev'],\n                  panelId === nextPanel && styles['View__panel--next'],\n                  panelId === swipeBackPrevPanel && iosStyles['View__panel--swipe-back-prev'],\n                  panelId === swipeBackNextPanel && iosStyles['View__panel--swipe-back-next'],\n                  swipeBackResult === SwipeBackResults.success &&\n                    iosStyles['View__panel--swipe-back-success'],\n                  swipeBackResult === SwipeBackResults.fail &&\n                    iosStyles['View__panel--swipe-back-failed'],\n                )}\n                onAnimationEnd={isTransitionTarget ? this.transitionEndHandler : undefined}\n                ref={(el) => panelId !== undefined && (this.panelNodes[panelId] = el)}\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div\n                  className={styles['View__panel-in']}\n                  style={{ marginTop: compensateScroll ? -scroll : undefined }}\n                >\n                  <NavTransitionProvider\n                    entering={panelId === nextPanel || panelId === swipeBackNextPanel}\n                  >\n                    {panel}\n                  </NavTransitionProvider>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        <AppRootPortal>\n          {hasPopout && <div className={styles['View__popout']}>{popout}</div>}\n          {hasModal && <div className={styles['View__modal']}>{modal}</div>}\n        </AppRootPortal>\n      </Touch>\n    );\n  }\n}\n\nexport const ViewInfinite = withContext(\n  withContext(\n    withContext(\n      withPlatform(withDOM<ViewInfiniteProps>(ViewInfiniteComponent)),\n      SplitColContext,\n      'splitCol',\n    ),\n    ConfigProviderContext,\n    'configProvider',\n  ),\n  ScrollContext,\n  'scroll',\n);\n"],"mappings":"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"}