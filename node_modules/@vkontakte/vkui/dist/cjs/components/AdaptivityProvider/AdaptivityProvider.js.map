{"version":3,"file":"AdaptivityProvider.js","names":["AdaptivityProvider","viewWidth","viewHeight","sizeX","sizeY","hasPointer","hasHover","children","bridge","useBridgeAdaptivity","React","useState","adaptivity","setAdaptivity","useEffect","calculateAdaptivity","type","viewportWidth","viewportHeight","BREAKPOINTS","DESKTOP","ViewWidth","TABLET","SMALL_TABLET","MOBILE","SMALL_MOBILE","MEDIUM_HEIGHT","ViewHeight","MEDIUM","MOBILE_LANDSCAPE_HEIGHT","SMALL","EXTRA_SMALL","SizeType","COMPACT","REGULAR","_hasPointer","undefined"],"sources":["../../../../src/components/AdaptivityProvider/AdaptivityProvider.tsx"],"sourcesContent":["import * as React from 'react';\nimport { hasMouse as _hasPointer } from '@vkontakte/vkjs';\nimport { SizeType, ViewWidth, ViewHeight, BREAKPOINTS } from '../../lib/adaptivity';\nimport { useBridgeAdaptivity, BridgeAdaptivity } from '../../hooks/useBridgeAdaptivity';\nimport { type AdaptivityProps, AdaptivityContext } from './AdaptivityContext';\n\nexport interface AdaptivityProviderProps extends AdaptivityProps {\n  children?: React.ReactNode;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/AdaptivityProvider\n */\nexport const AdaptivityProvider = ({\n  viewWidth,\n  viewHeight,\n  sizeX,\n  sizeY,\n  hasPointer,\n  hasHover,\n  children,\n}: React.PropsWithChildren<AdaptivityProps>) => {\n  const bridge = useBridgeAdaptivity();\n  const [adaptivity, setAdaptivity] = React.useState({\n    viewWidth,\n    viewHeight,\n    sizeX,\n    sizeY,\n    hasPointer,\n    hasHover,\n  });\n\n  React.useEffect(() => {\n    setAdaptivity(\n      calculateAdaptivity(\n        {\n          viewWidth,\n          viewHeight,\n          sizeX,\n          sizeY,\n          hasPointer,\n          hasHover,\n        },\n        bridge,\n      ),\n    );\n  }, [viewWidth, viewHeight, sizeX, sizeY, hasPointer, hasHover, bridge]);\n\n  return <AdaptivityContext.Provider value={adaptivity}>{children}</AdaptivityContext.Provider>;\n};\n\nfunction calculateAdaptivity(\n  { viewWidth, viewHeight, sizeX, sizeY, hasPointer, hasHover }: AdaptivityProps,\n  bridge: BridgeAdaptivity,\n) {\n  if (bridge.type === 'adaptive') {\n    const { viewportWidth, viewportHeight } = bridge;\n\n    if (viewportWidth >= BREAKPOINTS.DESKTOP) {\n      viewWidth = ViewWidth.DESKTOP;\n    } else if (viewportWidth >= BREAKPOINTS.TABLET) {\n      viewWidth = ViewWidth.TABLET;\n    } else if (viewportWidth >= BREAKPOINTS.SMALL_TABLET) {\n      viewWidth = ViewWidth.SMALL_TABLET;\n    } else if (viewportWidth >= BREAKPOINTS.MOBILE) {\n      viewWidth = ViewWidth.MOBILE;\n    } else {\n      viewWidth = ViewWidth.SMALL_MOBILE;\n    }\n\n    if (viewportHeight >= BREAKPOINTS.MEDIUM_HEIGHT) {\n      viewHeight = ViewHeight.MEDIUM;\n    } else if (viewportHeight > BREAKPOINTS.MOBILE_LANDSCAPE_HEIGHT) {\n      viewHeight = ViewHeight.SMALL;\n    } else {\n      viewHeight = ViewHeight.EXTRA_SMALL;\n    }\n\n    if (viewWidth <= ViewWidth.MOBILE) {\n      sizeX = SizeType.COMPACT;\n    } else {\n      sizeX = SizeType.REGULAR;\n    }\n\n    if (\n      (viewWidth >= ViewWidth.SMALL_TABLET && _hasPointer) ||\n      viewHeight <= ViewHeight.EXTRA_SMALL\n    ) {\n      sizeY = SizeType.COMPACT;\n    } else {\n      sizeY = SizeType.REGULAR;\n    }\n  } else if (bridge.type === 'force_mobile' || bridge.type === 'force_mobile_compact') {\n    viewWidth = ViewWidth.MOBILE;\n    sizeX = SizeType.COMPACT;\n\n    if (bridge.type === 'force_mobile_compact') {\n      sizeY = SizeType.COMPACT;\n    } else {\n      sizeY = SizeType.REGULAR;\n    }\n  } else {\n    if (sizeX === undefined && viewWidth !== undefined) {\n      if (viewWidth <= ViewWidth.MOBILE) {\n        sizeX = SizeType.COMPACT;\n      } else {\n        sizeX = SizeType.REGULAR;\n      }\n    }\n    if (sizeY === undefined && viewWidth !== undefined && viewHeight !== undefined) {\n      if (\n        (viewWidth >= ViewWidth.SMALL_TABLET && _hasPointer) ||\n        viewHeight <= ViewHeight.EXTRA_SMALL\n      ) {\n        sizeY = SizeType.COMPACT;\n      } else {\n        sizeY = SizeType.REGULAR;\n      }\n    }\n  }\n\n  return {\n    viewWidth,\n    viewHeight,\n    sizeX,\n    sizeY,\n    hasPointer,\n    hasHover,\n  };\n}\n"],"mappings":"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"}