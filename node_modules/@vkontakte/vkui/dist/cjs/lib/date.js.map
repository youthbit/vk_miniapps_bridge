{"version":3,"file":"date.js","names":["startOfDay","date","dayjs","startOf","toDate","endOfDay","endOf","startOfWeek","weekStart","day","weekDay","diff","endOfWeek","startOfMonth","endOfMonth","isFirstDayOfMonth","isLastDayOfMonth","isSame","format","isBefore","date1","date2","isAfter","isSameDay","isSameMonth","isWithinInterval","start","end","setMinutes","minute","set","setHours","hour","setMonth","month","setYear","year","addDays","add","subDays","subtract","addWeeks","week","subWeeks","addMonths","subMonths","eachDayOfInterval","dates","startDate","endDate","endTime","getTime","currentDate","push","Date","setDate","getDate","parse","input","referenceDate","match2","match4","entries","val","numVal","okay","parseInt","superRegExp","RegExp","map","item","join","store","Y","getFullYear","M","getMonth","D","h","getHours","m","getMinutes","s","getSeconds","ms","getMilliseconds","prevInputIndex","lastNonFormatting","lastFormatIndex","found","match","exec","length","atIndex","lastIndex","find","slice","value","key","newValue","isMatch","isNaN","getMillisecondsToTomorrow"],"sources":["../../../src/lib/date.ts"],"sourcesContent":["import dayjs from 'dayjs';\n\n// Using date-fns-like type for migration\ntype DirtyDate = Date | number;\n\nexport function startOfDay(date: DirtyDate) {\n  return dayjs(date).startOf('day').toDate();\n}\n\nexport function endOfDay(date: DirtyDate) {\n  return dayjs(date).endOf('day').toDate();\n}\n\nexport function startOfWeek(date: DirtyDate, weekStart = 0) {\n  weekStart = weekStart % 7;\n\n  const day = dayjs(date);\n  const weekDay = day.day();\n  const diff = (weekDay < weekStart ? 7 : 0) + weekDay - weekStart;\n\n  return day.date(day.date() - diff).toDate();\n}\n\nexport function endOfWeek(date: DirtyDate, weekStart = 0) {\n  const day = dayjs(startOfWeek(date, weekStart));\n\n  return day.date(day.date() + 6).toDate();\n}\n\nexport function startOfMonth(date: DirtyDate) {\n  return dayjs(date).startOf('month').toDate();\n}\n\nexport function endOfMonth(date: DirtyDate) {\n  return dayjs(date).endOf('month').toDate();\n}\n\nexport function isFirstDayOfMonth(date: DirtyDate) {\n  return dayjs(date).date() === 1;\n}\n\nexport function isLastDayOfMonth(date: DirtyDate) {\n  // isSameDay -- shorter, but not exact with date-fns behavior\n  // return isSameDay(date, dayjs(date).endOf(\"month\"));\n  return dayjs(date).endOf('day').isSame(dayjs(date).endOf('month'));\n}\n\nexport function format(date: DirtyDate, format: string) {\n  return dayjs(date).format(format);\n}\n\nexport function isBefore(date1: DirtyDate, date2: DirtyDate) {\n  // Exactly as date-fns does\n  // dayjs().isBefore() for slightly different approach\n  return dayjs(date1) < dayjs(date2);\n}\n\nexport function isAfter(date1: DirtyDate, date2: DirtyDate) {\n  return dayjs(date1) > dayjs(date2);\n}\n\nexport function isSameDay(date1: DirtyDate, date2: DirtyDate) {\n  return dayjs(date1).isSame(date2, 'day');\n}\n\nexport function isSameMonth(date1: DirtyDate, date2: DirtyDate) {\n  return dayjs(date1).isSame(date2, 'month');\n}\n\nexport function isWithinInterval(date: DirtyDate, start: DirtyDate, end: DirtyDate) {\n  const day = dayjs(date);\n  return day >= dayjs(start) && day <= dayjs(end);\n}\n\nexport function setMinutes(date: DirtyDate, minute: number) {\n  return dayjs(date).set('minute', minute).toDate();\n}\n\nexport function setHours(date: DirtyDate, hour: number) {\n  return dayjs(date).set('hour', hour).toDate();\n}\n\nexport function setMonth(date: DirtyDate, month: number) {\n  return dayjs(date).set('month', month).toDate();\n}\n\nexport function setYear(date: DirtyDate, year: number) {\n  return dayjs(date).set('year', year).toDate();\n}\n\nexport function addDays(date: DirtyDate, day: number) {\n  return dayjs(date).add(day, 'day').toDate();\n}\n\nexport function subDays(date: DirtyDate, day: number) {\n  return dayjs(date).subtract(day, 'day').toDate();\n}\n\nexport function addWeeks(date: DirtyDate, week: number) {\n  return dayjs(date).add(week, 'week').toDate();\n}\n\nexport function subWeeks(date: DirtyDate, week: number) {\n  return dayjs(date).subtract(week, 'week').toDate();\n}\n\nexport function addMonths(date: DirtyDate, month: number) {\n  return dayjs(date).add(month, 'month').toDate();\n}\n\nexport function subMonths(date: DirtyDate, month: number) {\n  return dayjs(date).subtract(month, 'month').toDate();\n}\n\n// Rip off date-fns\nexport function eachDayOfInterval(start: DirtyDate, end: DirtyDate) {\n  const dates: Date[] = [];\n  const startDate = dayjs(start).toDate();\n  const endDate = dayjs(end).toDate();\n\n  const endTime = endDate.getTime();\n  const currentDate = startDate;\n  currentDate.setHours(0, 0, 0, 0);\n\n  while (currentDate.getTime() <= endTime) {\n    dates.push(new Date(currentDate.getTime()));\n    currentDate.setDate(currentDate.getDate() + 1);\n    currentDate.setHours(0, 0, 0, 0);\n  }\n\n  return dates;\n}\n\nexport function parse(input: string, format: string, referenceDate: Date = new Date()) {\n  const match2 = /^\\d\\d/; // 00 - 99\n  const match4 = /^\\d{4}/; // 0000 - 9999\n\n  const entries: Array<[string, RegExp, (val: string) => [string, number, boolean]]> = [\n    ['YYYY', match4, (val) => ['Y', +val, true]],\n    [\n      'MM',\n      match2,\n      (val) => {\n        const numVal = +val;\n        const okay = numVal > 0 && numVal <= 12;\n\n        return ['M', numVal - 1, okay];\n      },\n    ],\n    ['DD', match2, (val) => ['D', +val, true]],\n    [\n      'HH',\n      match2,\n      (val) => {\n        const numVal = parseInt(val, 10);\n        const okay = numVal >= 0 && numVal < 24;\n\n        return ['h', numVal, okay];\n      },\n    ],\n    [\n      'mm',\n      match2,\n      (val) => {\n        const numVal = parseInt(val, 10);\n        const okay = numVal >= 0 && numVal < 60;\n\n        return ['m', numVal, okay];\n      },\n    ],\n  ];\n\n  const superRegExp = new RegExp(entries.map((item) => item[0]).join('|'), 'g');\n\n  const store: {\n    [key: string]: number;\n  } = {\n    Y: referenceDate.getFullYear(),\n    M: referenceDate.getMonth(),\n    D: referenceDate.getDate(),\n    h: referenceDate.getHours(),\n    m: referenceDate.getMinutes(),\n    s: referenceDate.getSeconds(),\n    ms: referenceDate.getMilliseconds(),\n  };\n\n  let prevInputIndex = 0;\n  let lastNonFormatting = '';\n  let lastFormatIndex = 0;\n  let found = false;\n\n  while (true) {\n    const match = superRegExp.exec(format);\n\n    if (!match) {\n      break;\n    }\n\n    const length = match[0].length;\n    const atIndex = superRegExp.lastIndex - length;\n\n    const item = entries.find((item) => item[0] === match[0]);\n\n    if (!item) {\n      return new Date('');\n    }\n\n    lastNonFormatting = format.slice(lastFormatIndex, atIndex);\n    lastFormatIndex = superRegExp.lastIndex;\n\n    if (\n      input.slice(prevInputIndex, prevInputIndex + lastNonFormatting.length) !== lastNonFormatting\n    ) {\n      return new Date('');\n    }\n\n    const value = input.slice(prevInputIndex + lastNonFormatting.length).match(item[1]);\n\n    if (!value) {\n      return new Date('');\n    }\n\n    prevInputIndex = prevInputIndex + lastNonFormatting.length + value[0].length;\n\n    const [key, newValue, okay] = item[2](value[0]);\n\n    if (!okay) {\n      return new Date('');\n    }\n\n    store[key] = newValue;\n    found = true;\n  }\n\n  if (!found) {\n    return new Date('');\n  }\n\n  const date = new Date(store.Y, store.M, store.D, store.h, store.m, store.s, store.ms);\n\n  // Since days of months are dynamic, they can't be validated in entries,\n  // so we check it here, in the finalized date\n  if (date.getMonth() !== store.M || date.getDate() !== store.D) {\n    return new Date('');\n  }\n\n  return date;\n}\n\nexport function isMatch(input: string, format: string) {\n  return !isNaN(+parse(input, format));\n}\n\nexport function getMillisecondsToTomorrow(date: DirtyDate) {\n  return dayjs(endOfDay(date)).diff(dayjs(date), 'ms');\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAKO,SAASA,UAAU,CAACC,IAAe,EAAE;EAC1C,OAAO,IAAAC,cAAK,EAACD,IAAI,CAAC,CAACE,OAAO,CAAC,KAAK,CAAC,CAACC,MAAM,EAAE;AAC5C;AAEO,SAASC,QAAQ,CAACJ,IAAe,EAAE;EACxC,OAAO,IAAAC,cAAK,EAACD,IAAI,CAAC,CAACK,KAAK,CAAC,KAAK,CAAC,CAACF,MAAM,EAAE;AAC1C;AAEO,SAASG,WAAW,CAACN,IAAe,EAAiB;EAAA,IAAfO,SAAS,uEAAG,CAAC;EACxDA,SAAS,GAAGA,SAAS,GAAG,CAAC;EAEzB,IAAMC,GAAG,GAAG,IAAAP,cAAK,EAACD,IAAI,CAAC;EACvB,IAAMS,OAAO,GAAGD,GAAG,CAACA,GAAG,EAAE;EACzB,IAAME,IAAI,GAAG,CAACD,OAAO,GAAGF,SAAS,GAAG,CAAC,GAAG,CAAC,IAAIE,OAAO,GAAGF,SAAS;EAEhE,OAAOC,GAAG,CAACR,IAAI,CAACQ,GAAG,CAACR,IAAI,EAAE,GAAGU,IAAI,CAAC,CAACP,MAAM,EAAE;AAC7C;AAEO,SAASQ,SAAS,CAACX,IAAe,EAAiB;EAAA,IAAfO,SAAS,uEAAG,CAAC;EACtD,IAAMC,GAAG,GAAG,IAAAP,cAAK,EAACK,WAAW,CAACN,IAAI,EAAEO,SAAS,CAAC,CAAC;EAE/C,OAAOC,GAAG,CAACR,IAAI,CAACQ,GAAG,CAACR,IAAI,EAAE,GAAG,CAAC,CAAC,CAACG,MAAM,EAAE;AAC1C;AAEO,SAASS,YAAY,CAACZ,IAAe,EAAE;EAC5C,OAAO,IAAAC,cAAK,EAACD,IAAI,CAAC,CAACE,OAAO,CAAC,OAAO,CAAC,CAACC,MAAM,EAAE;AAC9C;AAEO,SAASU,UAAU,CAACb,IAAe,EAAE;EAC1C,OAAO,IAAAC,cAAK,EAACD,IAAI,CAAC,CAACK,KAAK,CAAC,OAAO,CAAC,CAACF,MAAM,EAAE;AAC5C;AAEO,SAASW,iBAAiB,CAACd,IAAe,EAAE;EACjD,OAAO,IAAAC,cAAK,EAACD,IAAI,CAAC,CAACA,IAAI,EAAE,KAAK,CAAC;AACjC;AAEO,SAASe,gBAAgB,CAACf,IAAe,EAAE;EAChD;EACA;EACA,OAAO,IAAAC,cAAK,EAACD,IAAI,CAAC,CAACK,KAAK,CAAC,KAAK,CAAC,CAACW,MAAM,CAAC,IAAAf,cAAK,EAACD,IAAI,CAAC,CAACK,KAAK,CAAC,OAAO,CAAC,CAAC;AACpE;AAEO,SAASY,MAAM,CAACjB,IAAe,EAAEiB,MAAc,EAAE;EACtD,OAAO,IAAAhB,cAAK,EAACD,IAAI,CAAC,CAACiB,MAAM,CAACA,MAAM,CAAC;AACnC;AAEO,SAASC,QAAQ,CAACC,KAAgB,EAAEC,KAAgB,EAAE;EAC3D;EACA;EACA,OAAO,IAAAnB,cAAK,EAACkB,KAAK,CAAC,GAAG,IAAAlB,cAAK,EAACmB,KAAK,CAAC;AACpC;AAEO,SAASC,OAAO,CAACF,KAAgB,EAAEC,KAAgB,EAAE;EAC1D,OAAO,IAAAnB,cAAK,EAACkB,KAAK,CAAC,GAAG,IAAAlB,cAAK,EAACmB,KAAK,CAAC;AACpC;AAEO,SAASE,SAAS,CAACH,KAAgB,EAAEC,KAAgB,EAAE;EAC5D,OAAO,IAAAnB,cAAK,EAACkB,KAAK,CAAC,CAACH,MAAM,CAACI,KAAK,EAAE,KAAK,CAAC;AAC1C;AAEO,SAASG,WAAW,CAACJ,KAAgB,EAAEC,KAAgB,EAAE;EAC9D,OAAO,IAAAnB,cAAK,EAACkB,KAAK,CAAC,CAACH,MAAM,CAACI,KAAK,EAAE,OAAO,CAAC;AAC5C;AAEO,SAASI,gBAAgB,CAACxB,IAAe,EAAEyB,KAAgB,EAAEC,GAAc,EAAE;EAClF,IAAMlB,GAAG,GAAG,IAAAP,cAAK,EAACD,IAAI,CAAC;EACvB,OAAOQ,GAAG,IAAI,IAAAP,cAAK,EAACwB,KAAK,CAAC,IAAIjB,GAAG,IAAI,IAAAP,cAAK,EAACyB,GAAG,CAAC;AACjD;AAEO,SAASC,UAAU,CAAC3B,IAAe,EAAE4B,MAAc,EAAE;EAC1D,OAAO,IAAA3B,cAAK,EAACD,IAAI,CAAC,CAAC6B,GAAG,CAAC,QAAQ,EAAED,MAAM,CAAC,CAACzB,MAAM,EAAE;AACnD;AAEO,SAAS2B,QAAQ,CAAC9B,IAAe,EAAE+B,IAAY,EAAE;EACtD,OAAO,IAAA9B,cAAK,EAACD,IAAI,CAAC,CAAC6B,GAAG,CAAC,MAAM,EAAEE,IAAI,CAAC,CAAC5B,MAAM,EAAE;AAC/C;AAEO,SAAS6B,QAAQ,CAAChC,IAAe,EAAEiC,KAAa,EAAE;EACvD,OAAO,IAAAhC,cAAK,EAACD,IAAI,CAAC,CAAC6B,GAAG,CAAC,OAAO,EAAEI,KAAK,CAAC,CAAC9B,MAAM,EAAE;AACjD;AAEO,SAAS+B,OAAO,CAAClC,IAAe,EAAEmC,IAAY,EAAE;EACrD,OAAO,IAAAlC,cAAK,EAACD,IAAI,CAAC,CAAC6B,GAAG,CAAC,MAAM,EAAEM,IAAI,CAAC,CAAChC,MAAM,EAAE;AAC/C;AAEO,SAASiC,OAAO,CAACpC,IAAe,EAAEQ,GAAW,EAAE;EACpD,OAAO,IAAAP,cAAK,EAACD,IAAI,CAAC,CAACqC,GAAG,CAAC7B,GAAG,EAAE,KAAK,CAAC,CAACL,MAAM,EAAE;AAC7C;AAEO,SAASmC,OAAO,CAACtC,IAAe,EAAEQ,GAAW,EAAE;EACpD,OAAO,IAAAP,cAAK,EAACD,IAAI,CAAC,CAACuC,QAAQ,CAAC/B,GAAG,EAAE,KAAK,CAAC,CAACL,MAAM,EAAE;AAClD;AAEO,SAASqC,QAAQ,CAACxC,IAAe,EAAEyC,IAAY,EAAE;EACtD,OAAO,IAAAxC,cAAK,EAACD,IAAI,CAAC,CAACqC,GAAG,CAACI,IAAI,EAAE,MAAM,CAAC,CAACtC,MAAM,EAAE;AAC/C;AAEO,SAASuC,QAAQ,CAAC1C,IAAe,EAAEyC,IAAY,EAAE;EACtD,OAAO,IAAAxC,cAAK,EAACD,IAAI,CAAC,CAACuC,QAAQ,CAACE,IAAI,EAAE,MAAM,CAAC,CAACtC,MAAM,EAAE;AACpD;AAEO,SAASwC,SAAS,CAAC3C,IAAe,EAAEiC,KAAa,EAAE;EACxD,OAAO,IAAAhC,cAAK,EAACD,IAAI,CAAC,CAACqC,GAAG,CAACJ,KAAK,EAAE,OAAO,CAAC,CAAC9B,MAAM,EAAE;AACjD;AAEO,SAASyC,SAAS,CAAC5C,IAAe,EAAEiC,KAAa,EAAE;EACxD,OAAO,IAAAhC,cAAK,EAACD,IAAI,CAAC,CAACuC,QAAQ,CAACN,KAAK,EAAE,OAAO,CAAC,CAAC9B,MAAM,EAAE;AACtD;;AAEA;AACO,SAAS0C,iBAAiB,CAACpB,KAAgB,EAAEC,GAAc,EAAE;EAClE,IAAMoB,KAAa,GAAG,EAAE;EACxB,IAAMC,SAAS,GAAG,IAAA9C,cAAK,EAACwB,KAAK,CAAC,CAACtB,MAAM,EAAE;EACvC,IAAM6C,OAAO,GAAG,IAAA/C,cAAK,EAACyB,GAAG,CAAC,CAACvB,MAAM,EAAE;EAEnC,IAAM8C,OAAO,GAAGD,OAAO,CAACE,OAAO,EAAE;EACjC,IAAMC,WAAW,GAAGJ,SAAS;EAC7BI,WAAW,CAACrB,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAEhC,OAAOqB,WAAW,CAACD,OAAO,EAAE,IAAID,OAAO,EAAE;IACvCH,KAAK,CAACM,IAAI,CAAC,IAAIC,IAAI,CAACF,WAAW,CAACD,OAAO,EAAE,CAAC,CAAC;IAC3CC,WAAW,CAACG,OAAO,CAACH,WAAW,CAACI,OAAO,EAAE,GAAG,CAAC,CAAC;IAC9CJ,WAAW,CAACrB,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClC;EAEA,OAAOgB,KAAK;AACd;AAEO,SAASU,KAAK,CAACC,KAAa,EAAExC,MAAc,EAAoC;EAAA,IAAlCyC,aAAmB,uEAAG,IAAIL,IAAI,EAAE;EACnF,IAAMM,MAAM,GAAG,OAAO,CAAC,CAAC;EACxB,IAAMC,MAAM,GAAG,QAAQ,CAAC,CAAC;;EAEzB,IAAMC,OAA4E,GAAG,CACnF,CAAC,MAAM,EAAED,MAAM,EAAE,UAACE,GAAG;IAAA,OAAK,CAAC,GAAG,EAAE,CAACA,GAAG,EAAE,IAAI,CAAC;EAAA,EAAC,EAC5C,CACE,IAAI,EACJH,MAAM,EACN,UAACG,GAAG,EAAK;IACP,IAAMC,MAAM,GAAG,CAACD,GAAG;IACnB,IAAME,IAAI,GAAGD,MAAM,GAAG,CAAC,IAAIA,MAAM,IAAI,EAAE;IAEvC,OAAO,CAAC,GAAG,EAAEA,MAAM,GAAG,CAAC,EAAEC,IAAI,CAAC;EAChC,CAAC,CACF,EACD,CAAC,IAAI,EAAEL,MAAM,EAAE,UAACG,GAAG;IAAA,OAAK,CAAC,GAAG,EAAE,CAACA,GAAG,EAAE,IAAI,CAAC;EAAA,EAAC,EAC1C,CACE,IAAI,EACJH,MAAM,EACN,UAACG,GAAG,EAAK;IACP,IAAMC,MAAM,GAAGE,QAAQ,CAACH,GAAG,EAAE,EAAE,CAAC;IAChC,IAAME,IAAI,GAAGD,MAAM,IAAI,CAAC,IAAIA,MAAM,GAAG,EAAE;IAEvC,OAAO,CAAC,GAAG,EAAEA,MAAM,EAAEC,IAAI,CAAC;EAC5B,CAAC,CACF,EACD,CACE,IAAI,EACJL,MAAM,EACN,UAACG,GAAG,EAAK;IACP,IAAMC,MAAM,GAAGE,QAAQ,CAACH,GAAG,EAAE,EAAE,CAAC;IAChC,IAAME,IAAI,GAAGD,MAAM,IAAI,CAAC,IAAIA,MAAM,GAAG,EAAE;IAEvC,OAAO,CAAC,GAAG,EAAEA,MAAM,EAAEC,IAAI,CAAC;EAC5B,CAAC,CACF,CACF;EAED,IAAME,WAAW,GAAG,IAAIC,MAAM,CAACN,OAAO,CAACO,GAAG,CAAC,UAACC,IAAI;IAAA,OAAKA,IAAI,CAAC,CAAC,CAAC;EAAA,EAAC,CAACC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC;EAE7E,IAAMC,KAEL,GAAG;IACFC,CAAC,EAAEd,aAAa,CAACe,WAAW,EAAE;IAC9BC,CAAC,EAAEhB,aAAa,CAACiB,QAAQ,EAAE;IAC3BC,CAAC,EAAElB,aAAa,CAACH,OAAO,EAAE;IAC1BsB,CAAC,EAAEnB,aAAa,CAACoB,QAAQ,EAAE;IAC3BC,CAAC,EAAErB,aAAa,CAACsB,UAAU,EAAE;IAC7BC,CAAC,EAAEvB,aAAa,CAACwB,UAAU,EAAE;IAC7BC,EAAE,EAAEzB,aAAa,CAAC0B,eAAe;EACnC,CAAC;EAED,IAAIC,cAAc,GAAG,CAAC;EACtB,IAAIC,iBAAiB,GAAG,EAAE;EAC1B,IAAIC,eAAe,GAAG,CAAC;EACvB,IAAIC,KAAK,GAAG,KAAK;EAAC;IAGhB,IAAMC,KAAK,GAAGvB,WAAW,CAACwB,IAAI,CAACzE,MAAM,CAAC;IAEtC,IAAI,CAACwE,KAAK,EAAE;MACV;IACF;IAEA,IAAME,MAAM,GAAGF,KAAK,CAAC,CAAC,CAAC,CAACE,MAAM;IAC9B,IAAMC,OAAO,GAAG1B,WAAW,CAAC2B,SAAS,GAAGF,MAAM;IAE9C,IAAMtB,IAAI,GAAGR,OAAO,CAACiC,IAAI,CAAC,UAACzB,IAAI;MAAA,OAAKA,IAAI,CAAC,CAAC,CAAC,KAAKoB,KAAK,CAAC,CAAC,CAAC;IAAA,EAAC;IAEzD,IAAI,CAACpB,IAAI,EAAE;MACT;QAAA,GAAO,IAAIhB,IAAI,CAAC,EAAE;MAAC;IACrB;IAEAiC,iBAAiB,GAAGrE,MAAM,CAAC8E,KAAK,CAACR,eAAe,EAAEK,OAAO,CAAC;IAC1DL,eAAe,GAAGrB,WAAW,CAAC2B,SAAS;IAEvC,IACEpC,KAAK,CAACsC,KAAK,CAACV,cAAc,EAAEA,cAAc,GAAGC,iBAAiB,CAACK,MAAM,CAAC,KAAKL,iBAAiB,EAC5F;MACA;QAAA,GAAO,IAAIjC,IAAI,CAAC,EAAE;MAAC;IACrB;IAEA,IAAM2C,KAAK,GAAGvC,KAAK,CAACsC,KAAK,CAACV,cAAc,GAAGC,iBAAiB,CAACK,MAAM,CAAC,CAACF,KAAK,CAACpB,IAAI,CAAC,CAAC,CAAC,CAAC;IAEnF,IAAI,CAAC2B,KAAK,EAAE;MACV;QAAA,GAAO,IAAI3C,IAAI,CAAC,EAAE;MAAC;IACrB;IAEAgC,cAAc,GAAGA,cAAc,GAAGC,iBAAiB,CAACK,MAAM,GAAGK,KAAK,CAAC,CAAC,CAAC,CAACL,MAAM;IAE5E,aAA8BtB,IAAI,CAAC,CAAC,CAAC,CAAC2B,KAAK,CAAC,CAAC,CAAC,CAAC;MAAA;MAAxCC,GAAG;MAAEC,QAAQ;MAAElC,IAAI;IAE1B,IAAI,CAACA,IAAI,EAAE;MACT;QAAA,GAAO,IAAIX,IAAI,CAAC,EAAE;MAAC;IACrB;IAEAkB,KAAK,CAAC0B,GAAG,CAAC,GAAGC,QAAQ;IACrBV,KAAK,GAAG,IAAI;EAAC;EAxCf,OAAO,IAAI,EAAE;IAAA;IAAA,sBAIT;IAAM;EAqCV;EAEA,IAAI,CAACA,KAAK,EAAE;IACV,OAAO,IAAInC,IAAI,CAAC,EAAE,CAAC;EACrB;EAEA,IAAMrD,IAAI,GAAG,IAAIqD,IAAI,CAACkB,KAAK,CAACC,CAAC,EAAED,KAAK,CAACG,CAAC,EAAEH,KAAK,CAACK,CAAC,EAAEL,KAAK,CAACM,CAAC,EAAEN,KAAK,CAACQ,CAAC,EAAER,KAAK,CAACU,CAAC,EAAEV,KAAK,CAACY,EAAE,CAAC;;EAErF;EACA;EACA,IAAInF,IAAI,CAAC2E,QAAQ,EAAE,KAAKJ,KAAK,CAACG,CAAC,IAAI1E,IAAI,CAACuD,OAAO,EAAE,KAAKgB,KAAK,CAACK,CAAC,EAAE;IAC7D,OAAO,IAAIvB,IAAI,CAAC,EAAE,CAAC;EACrB;EAEA,OAAOrD,IAAI;AACb;AAEO,SAASmG,OAAO,CAAC1C,KAAa,EAAExC,MAAc,EAAE;EACrD,OAAO,CAACmF,KAAK,CAAC,CAAC5C,KAAK,CAACC,KAAK,EAAExC,MAAM,CAAC,CAAC;AACtC;AAEO,SAASoF,yBAAyB,CAACrG,IAAe,EAAE;EACzD,OAAO,IAAAC,cAAK,EAACG,QAAQ,CAACJ,IAAI,CAAC,CAAC,CAACU,IAAI,CAAC,IAAAT,cAAK,EAACD,IAAI,CAAC,EAAE,IAAI,CAAC;AACtD"}