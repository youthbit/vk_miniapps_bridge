{"version":3,"file":"useWaitTransitionFinish.js","names":["useWaitTransitionFinish","timeoutRef","React","useRef","useDOM","document","detach","noop","remove","useCallback","current","waitTransitionFinish","element","eventHandler","durationFallback","hidden","transitionEvent","supported","name","addEventListener","removeEventListener","clearTimeout","setTimeout"],"sources":["../../../src/hooks/useWaitTransitionFinish.ts"],"sourcesContent":["import * as React from 'react';\nimport { useDOM } from '../lib/dom';\nimport { noop } from '@vkontakte/vkjs';\nimport { transitionEvent } from '../lib/supportEvents';\n\nexport const useWaitTransitionFinish = () => {\n  const timeoutRef = React.useRef<ReturnType<typeof setTimeout> | null>(null);\n  const { document } = useDOM();\n  const detach = React.useRef(noop);\n\n  const remove = React.useCallback(() => {\n    detach.current();\n    detach.current = noop;\n  }, []);\n\n  const waitTransitionFinish = React.useCallback(\n    (element: HTMLElement | null, eventHandler: VoidFunction, durationFallback: number) => {\n      if (element) {\n        if (!document?.hidden && transitionEvent.supported && transitionEvent.name) {\n          remove();\n          element.addEventListener(transitionEvent.name, eventHandler);\n          detach.current = () => {\n            if (transitionEvent.name) {\n              element.removeEventListener(transitionEvent.name, eventHandler);\n            }\n          };\n        } else {\n          if (timeoutRef?.current) {\n            clearTimeout(timeoutRef.current);\n          }\n          timeoutRef.current = setTimeout(eventHandler, durationFallback);\n        }\n      }\n    },\n    [document, remove, timeoutRef],\n  );\n\n  return {\n    waitTransitionFinish,\n  };\n};\n"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AAEO,IAAMA,uBAAuB,GAAG,SAA1BA,uBAAuB,GAAS;EAC3C,IAAMC,UAAU,GAAGC,KAAK,CAACC,MAAM,CAAuC,IAAI,CAAC;EAC3E,cAAqB,IAAAC,WAAM,GAAE;IAArBC,QAAQ,WAARA,QAAQ;EAChB,IAAMC,MAAM,GAAGJ,KAAK,CAACC,MAAM,CAACI,UAAI,CAAC;EAEjC,IAAMC,MAAM,GAAGN,KAAK,CAACO,WAAW,CAAC,YAAM;IACrCH,MAAM,CAACI,OAAO,EAAE;IAChBJ,MAAM,CAACI,OAAO,GAAGH,UAAI;EACvB,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMI,oBAAoB,GAAGT,KAAK,CAACO,WAAW,CAC5C,UAACG,OAA2B,EAAEC,YAA0B,EAAEC,gBAAwB,EAAK;IACrF,IAAIF,OAAO,EAAE;MACX,IAAI,EAACP,QAAQ,aAARA,QAAQ,eAARA,QAAQ,CAAEU,MAAM,KAAIC,8BAAe,CAACC,SAAS,IAAID,8BAAe,CAACE,IAAI,EAAE;QAC1EV,MAAM,EAAE;QACRI,OAAO,CAACO,gBAAgB,CAACH,8BAAe,CAACE,IAAI,EAAEL,YAAY,CAAC;QAC5DP,MAAM,CAACI,OAAO,GAAG,YAAM;UACrB,IAAIM,8BAAe,CAACE,IAAI,EAAE;YACxBN,OAAO,CAACQ,mBAAmB,CAACJ,8BAAe,CAACE,IAAI,EAAEL,YAAY,CAAC;UACjE;QACF,CAAC;MACH,CAAC,MAAM;QACL,IAAIZ,UAAU,aAAVA,UAAU,eAAVA,UAAU,CAAES,OAAO,EAAE;UACvBW,YAAY,CAACpB,UAAU,CAACS,OAAO,CAAC;QAClC;QACAT,UAAU,CAACS,OAAO,GAAGY,UAAU,CAACT,YAAY,EAAEC,gBAAgB,CAAC;MACjE;IACF;EACF,CAAC,EACD,CAACT,QAAQ,EAAEG,MAAM,EAAEP,UAAU,CAAC,CAC/B;EAED,OAAO;IACLU,oBAAoB,EAApBA;EACF,CAAC;AACH,CAAC;AAAC"}