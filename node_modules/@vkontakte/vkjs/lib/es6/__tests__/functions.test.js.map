{"version":3,"file":"functions.test.js","names":["expect","jest","test","describe","beforeEach","it","debounce","once","throttle","Mock","threshold","fn","fnThrottled","useFakeTimers","setSystemTime","mock","calls","toEqual","advanceTimersByTime","cancel","toHaveBeenCalledTimes","toHaveBeenCalledWith","delay","fnDebounced","not","toHaveBeenCalled","fnOnce","toBeCalledTimes"],"sources":["../../../src/__tests__/functions.test.ts"],"sourcesContent":["import { expect, jest, test, describe, beforeEach, it } from '@jest/globals';\nimport { debounce, once, throttle } from '../functions';\nimport { AnyFunction } from '../types';\n\nimport Mock = jest.Mock;\n\ndescribe('throttle', () => {\n  const threshold = 50;\n  let fn: Mock<AnyFunction>;\n  let fnThrottled: ReturnType<typeof throttle>;\n\n  beforeEach(() => {\n    jest.useFakeTimers();\n    jest.setSystemTime(100);\n    fn = jest.fn();\n    fnThrottled = throttle(fn, threshold);\n  });\n\n  test('should call functions as usual if they exceed threshold interval', () => {\n    fnThrottled(1);\n    expect(fn.mock.calls).toEqual([[1]]);\n\n    jest.advanceTimersByTime(threshold);\n    fnThrottled(2);\n    expect(fn.mock.calls).toEqual([[1], [2]]);\n  });\n\n  test('should trigger last call at the end of threshold', () => {\n    fnThrottled(1);\n    expect(fn.mock.calls).toEqual([[1]]);\n    jest.advanceTimersByTime(10);\n\n    fnThrottled(2);\n    jest.advanceTimersByTime(threshold - 10);\n    expect(fn.mock.calls).toEqual([[1], [2]]);\n  });\n\n  test('should call not more than once per threshold and preserve correct call order', () => {\n    fnThrottled(1);\n    // call function immediately after the first call\n    expect(fn.mock.calls).toEqual([[1]]);\n\n    fnThrottled(2);\n    fnThrottled(3);\n    jest.advanceTimersByTime(threshold - 10); // 40ms\n    // throttle following calls until the threshold is reached\n    expect(fn.mock.calls).toEqual([[1]]);\n\n    fnThrottled(4);\n    jest.advanceTimersByTime(10); // 50ms\n    // call function with last arguments after the threshold is reached\n    expect(fn.mock.calls).toEqual([[1], [4]]);\n\n    jest.advanceTimersByTime(10); // 60ms\n    fnThrottled(5);\n    // don't call function immediately and wait until threshold reached\n    expect(fn.mock.calls).toEqual([[1], [4]]);\n\n    jest.advanceTimersByTime(threshold - 10); // 100ms\n    expect(fn.mock.calls).toEqual([[1], [4], [5]]);\n  });\n\n  it('should cancel throttled call', function () {\n    fnThrottled(1);\n    fnThrottled(2);\n    fnThrottled(3);\n    fnThrottled.cancel();\n    jest.advanceTimersByTime(threshold);\n\n    expect(fn).toHaveBeenCalledTimes(1);\n    expect(fn).toHaveBeenCalledWith(1);\n  });\n});\n\ndescribe('debounce', () => {\n  const delay = 50;\n  let fn: Mock<AnyFunction>;\n  let fnDebounced: ReturnType<typeof debounce>;\n\n  beforeEach(() => {\n    jest.useFakeTimers();\n    jest.setSystemTime(100);\n    fn = jest.fn();\n    fnDebounced = debounce(fn, delay);\n  });\n\n  test('should debounce function call', () => {\n    fnDebounced(1);\n    expect(fn.mock.calls).toEqual([]);\n\n    jest.advanceTimersByTime(10); // 10ms\n    fnDebounced(2);\n\n    jest.advanceTimersByTime(delay - 10); // 50ms\n    expect(fn.mock.calls).toEqual([]);\n\n    jest.advanceTimersByTime(10); // 60ms\n    expect(fn.mock.calls).toEqual([[2]]);\n  });\n\n  it('should cancel debounced call', function () {\n    fnDebounced(1);\n    fnDebounced(2);\n    fnDebounced(3);\n    fnDebounced.cancel();\n    jest.advanceTimersByTime(delay);\n\n    expect(fn).not.toHaveBeenCalled();\n  });\n});\n\ndescribe('once', () => {\n  test('should be called once', () => {\n    const fn = jest.fn();\n    const fnOnce = once(fn);\n\n    fnOnce();\n    fnOnce();\n    fnOnce();\n\n    expect(fn).toBeCalledTimes(1);\n  });\n});\n"],"mappings":"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"}