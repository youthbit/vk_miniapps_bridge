{"version":3,"file":"IOSDetections.js","names":["canUseDOM","IPHONE_SAFARI_BOTTOM_BAR","IPHONE_X_SAFARI_BOTTOM_BAR","IPHONE_KEYBOARD_REJECT_OFFSET","IOS_NO_KEYBOARD_ALLOWED_OFFSET","detectIOS","ua","navigator","userAgent","toLowerCase","isIPadOS","checkIPadOS","isIPad","indexOf","isIPhone","search","isIOS","iosVersion","match","iosMajor","iosMinor","split","isScrollBasedViewport","isWKWebView","checkWKWebView","isIPhoneX","screen","width","height","window","devicePixelRatio","isIOSChrome","isLandscapePhone","Math","abs","orientation","webkit","messageHandlers","lte9","test","String","HTMLElement","idb","indexedDB","standalone","statusbar","visible","notIOS","macOS"],"sources":["../../src/IOSDetections.ts"],"sourcesContent":["import { canUseDOM } from './dom';\n\nexport const IPHONE_SAFARI_BOTTOM_BAR = 45;\nexport const IPHONE_X_SAFARI_BOTTOM_BAR = 85;\n\nexport const IPHONE_KEYBOARD_REJECT_OFFSET = 180;\n\n// 44 iPhone, 55 iPad, iPad Pro 69\nexport const IOS_NO_KEYBOARD_ALLOWED_OFFSET = 70;\n\nexport function detectIOS(ua?: string) {\n  if (!ua) {\n    ua = canUseDOM ? navigator.userAgent.toLowerCase() : '';\n  }\n\n  const isIPadOS = checkIPadOS(ua);\n  const isIPad = isIPadOS || ua.indexOf('ipad') !== -1;\n  const isIPhone = !isIPad && ua.search(/iphone|ipod/) !== -1;\n  const isIOS = isIPhone || isIPad;\n\n  let iosVersion = isIOS && ua.match(/OS ([\\d_]+) like Mac OS X/i);\n  let iosMajor = 0;\n  let iosMinor = 0;\n\n  if (isIPadOS) {\n    iosMajor = 13;\n    iosMinor = 0;\n  } else if (iosVersion) {\n    iosVersion = iosVersion[1].split('_');\n    iosMajor = +iosVersion[0];\n    iosMinor = +iosVersion[1];\n  }\n\n  iosVersion = null;\n\n  const isScrollBasedViewport = iosMajor < 13 && !(iosMajor === 11 && iosMinor < 3);\n  const isWKWebView = isIOS && checkWKWebView(ua);\n\n  let isIPhoneX = false;\n\n  if (canUseDOM) {\n    isIPhoneX =\n      isIOS && screen.width === 375 && screen.height === 812 && window.devicePixelRatio === 3;\n  }\n\n  const isIOSChrome = ua.search(/crios/i) !== -1;\n\n  return {\n    isIPad,\n    isIPhone,\n    isIOS,\n    isIPadOS,\n    iosMajor,\n    iosMinor,\n    isWKWebView,\n    isScrollBasedViewport,\n    isIPhoneX,\n    isIOSChrome,\n  };\n}\n\nexport const {\n  isIPad,\n  isIPhone,\n  isIOS,\n  isIPadOS,\n  iosMajor,\n  iosMinor,\n  isWKWebView,\n  isScrollBasedViewport,\n  isIPhoneX,\n  isIOSChrome,\n} = detectIOS();\n\nexport function isLandscapePhone() {\n  return Math.abs(window.orientation) === 90 && !isIPad;\n}\n\n// Reference:\n// https://stackoverflow.com/questions/28795476/detect-if-page-is-loaded-inside-wkwebview-in-javascript/30495399#30495399\nfunction checkWKWebView(ua: string) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  const webkit = (window as any).webkit;\n\n  if (webkit && webkit.messageHandlers) {\n    return true;\n  }\n\n  const lte9 = /constructor/i.test(String(window.HTMLElement));\n  const idb = !!window.indexedDB;\n\n  if (\n    ua.indexOf('safari') !== -1 &&\n    ua.indexOf('version') !== -1 &&\n    !(navigator as any).standalone\n  ) {\n    // Safari (WKWebView/Nitro since 6+)\n  } else if ((!idb && lte9) || !(window.statusbar && window.statusbar.visible)) {\n    // UIWebView\n  } else if (!lte9 || idb) {\n    // WKWebView\n    return true;\n  }\n\n  return false;\n}\n\nexport function checkIPadOS(ua: string) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  const notIOS = !/ipad|iphone|ipod/.test(ua);\n  const macOS = /mac os/.test(ua);\n\n  if (macOS && notIOS && typeof (navigator as any).standalone === 'boolean') {\n    return true;\n  }\n\n  return false;\n}\n"],"mappings":"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"}