{"version":3,"file":"querystring.js","names":["parse","query","trim","replace","matches","exec","str","split","reduce","acc","item","param","decodeURIComponent","stringify","data","options","encode","value","encodeURIComponent","String","Object","keys","key","undefined","skipNull","push","join","Array","isArray","map","arrayItem","querystring"],"sources":["../src/querystring.ts"],"sourcesContent":["export interface ParsedQuery<T = string> {\n  [key: string]: T | T[] | null;\n}\n\nfunction parse(query: string | any): ParsedQuery {\n  if (typeof query !== 'string') {\n    return {};\n  }\n\n  query = query.trim().replace(/^[?#&]/, '');\n  if (!query) {\n    return {};\n  }\n\n  const matches = /\\?(.+)$/gi.exec(query);\n  const str = matches ? matches[1] : query;\n\n  return str.split('&').reduce((acc: ParsedQuery, item: string) => {\n    const param = item.split('=');\n\n    if (param[1]) {\n      acc[param[0]] = decodeURIComponent(param[1]);\n    }\n\n    return acc;\n  }, {});\n}\n\ntype StringifyQueryItem = string | boolean | number | null | undefined;\n\ntype StringifyQuery = Record<string, StringifyQueryItem | readonly StringifyQueryItem[]>;\n\ninterface StringifyOptions {\n  /**\n   * URL encode the keys and values\n   *\n   * @default true\n   */\n  encode?: boolean;\n\n  /**\n   * Skip keys with `null` as the value.\n   * Keys with `undefined` as the value are always ignored.\n   *\n   * @default true\n   */\n  skipNull?: true;\n}\n\nfunction stringify(data: StringifyQuery, options: StringifyOptions = {}): string {\n  if (typeof data !== 'object' || data === null) {\n    return '';\n  }\n\n  options = {\n    encode: true,\n    ...options,\n  };\n\n  const encode = (value: any): string => {\n    return options.encode ? encodeURIComponent(value) : String(value);\n  };\n\n  return Object.keys(data)\n    .reduce<string[]>((acc, key) => {\n      const value = data[key];\n\n      if (value === undefined) {\n        return acc;\n      }\n\n      if (value === null) {\n        if (!options.skipNull) {\n          acc.push([encode(key), ''].join('='));\n        }\n\n        return acc;\n      }\n\n      if (Array.isArray(value)) {\n        value\n          .map((arrayItem) => {\n            acc.push(`${encode(key)}[]=${encode(arrayItem)}`);\n          })\n          .join();\n        return acc;\n      }\n\n      acc.push([encode(key), encode(value)].join('='));\n      return acc;\n    }, [])\n    .join('&');\n}\n\nexport const querystring = {\n  parse,\n  stringify,\n};\n"],"mappings":";;;;;;;;;;;AAIA,SAASA,KAAK,CAACC,KAAmB,EAAe;EAC/C,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7B,OAAO,CAAC,CAAC;EACX;EAEAA,KAAK,GAAGA,KAAK,CAACC,IAAI,EAAE,CAACC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC;EAC1C,IAAI,CAACF,KAAK,EAAE;IACV,OAAO,CAAC,CAAC;EACX;EAEA,IAAMG,OAAO,GAAG,WAAW,CAACC,IAAI,CAACJ,KAAK,CAAC;EACvC,IAAMK,GAAG,GAAGF,OAAO,GAAGA,OAAO,CAAC,CAAC,CAAC,GAAGH,KAAK;EAExC,OAAOK,GAAG,CAACC,KAAK,CAAC,GAAG,CAAC,CAACC,MAAM,CAAC,UAACC,GAAgB,EAAEC,IAAY,EAAK;IAC/D,IAAMC,KAAK,GAAGD,IAAI,CAACH,KAAK,CAAC,GAAG,CAAC;IAE7B,IAAII,KAAK,CAAC,CAAC,CAAC,EAAE;MACZF,GAAG,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC,GAAGC,kBAAkB,CAACD,KAAK,CAAC,CAAC,CAAC,CAAC;IAC9C;IAEA,OAAOF,GAAG;EACZ,CAAC,EAAE,CAAC,CAAC,CAAC;AACR;AAuBA,SAASI,SAAS,CAACC,IAAoB,EAA0C;EAAA,IAAxCC,OAAyB,uEAAG,CAAC,CAAC;EACrE,IAAI,yBAAOD,IAAI,MAAK,QAAQ,IAAIA,IAAI,KAAK,IAAI,EAAE;IAC7C,OAAO,EAAE;EACX;EAEAC,OAAO;IACLC,MAAM,EAAE;EAAI,GACTD,OAAO,CACX;EAED,IAAMC,MAAM,GAAG,SAATA,MAAM,CAAIC,KAAU,EAAa;IACrC,OAAOF,OAAO,CAACC,MAAM,GAAGE,kBAAkB,CAACD,KAAK,CAAC,GAAGE,MAAM,CAACF,KAAK,CAAC;EACnE,CAAC;EAED,OAAOG,MAAM,CAACC,IAAI,CAACP,IAAI,CAAC,CACrBN,MAAM,CAAW,UAACC,GAAG,EAAEa,GAAG,EAAK;IAC9B,IAAML,KAAK,GAAGH,IAAI,CAACQ,GAAG,CAAC;IAEvB,IAAIL,KAAK,KAAKM,SAAS,EAAE;MACvB,OAAOd,GAAG;IACZ;IAEA,IAAIQ,KAAK,KAAK,IAAI,EAAE;MAClB,IAAI,CAACF,OAAO,CAACS,QAAQ,EAAE;QACrBf,GAAG,CAACgB,IAAI,CAAC,CAACT,MAAM,CAACM,GAAG,CAAC,EAAE,EAAE,CAAC,CAACI,IAAI,CAAC,GAAG,CAAC,CAAC;MACvC;MAEA,OAAOjB,GAAG;IACZ;IAEA,IAAIkB,KAAK,CAACC,OAAO,CAACX,KAAK,CAAC,EAAE;MACxBA,KAAK,CACFY,GAAG,CAAC,UAACC,SAAS,EAAK;QAClBrB,GAAG,CAACgB,IAAI,WAAIT,MAAM,CAACM,GAAG,CAAC,gBAAMN,MAAM,CAACc,SAAS,CAAC,EAAG;MACnD,CAAC,CAAC,CACDJ,IAAI,EAAE;MACT,OAAOjB,GAAG;IACZ;IAEAA,GAAG,CAACgB,IAAI,CAAC,CAACT,MAAM,CAACM,GAAG,CAAC,EAAEN,MAAM,CAACC,KAAK,CAAC,CAAC,CAACS,IAAI,CAAC,GAAG,CAAC,CAAC;IAChD,OAAOjB,GAAG;EACZ,CAAC,EAAE,EAAE,CAAC,CACLiB,IAAI,CAAC,GAAG,CAAC;AACd;AAEO,IAAMK,WAAW,GAAG;EACzB/B,KAAK,EAALA,KAAK;EACLa,SAAS,EAATA;AACF,CAAC;AAAC"}