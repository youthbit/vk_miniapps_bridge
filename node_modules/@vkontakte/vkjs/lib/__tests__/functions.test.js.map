{"version":3,"file":"functions.test.js","names":["Mock","jest","describe","threshold","fn","fnThrottled","beforeEach","useFakeTimers","setSystemTime","throttle","test","expect","mock","calls","toEqual","advanceTimersByTime","it","cancel","toHaveBeenCalledTimes","toHaveBeenCalledWith","delay","fnDebounced","debounce","not","toHaveBeenCalled","fnOnce","once","toBeCalledTimes"],"sources":["../../src/__tests__/functions.test.ts"],"sourcesContent":["import { expect, jest, test, describe, beforeEach, it } from '@jest/globals';\nimport { debounce, once, throttle } from '../functions';\nimport { AnyFunction } from '../types';\n\nimport Mock = jest.Mock;\n\ndescribe('throttle', () => {\n  const threshold = 50;\n  let fn: Mock<AnyFunction>;\n  let fnThrottled: ReturnType<typeof throttle>;\n\n  beforeEach(() => {\n    jest.useFakeTimers();\n    jest.setSystemTime(100);\n    fn = jest.fn();\n    fnThrottled = throttle(fn, threshold);\n  });\n\n  test('should call functions as usual if they exceed threshold interval', () => {\n    fnThrottled(1);\n    expect(fn.mock.calls).toEqual([[1]]);\n\n    jest.advanceTimersByTime(threshold);\n    fnThrottled(2);\n    expect(fn.mock.calls).toEqual([[1], [2]]);\n  });\n\n  test('should trigger last call at the end of threshold', () => {\n    fnThrottled(1);\n    expect(fn.mock.calls).toEqual([[1]]);\n    jest.advanceTimersByTime(10);\n\n    fnThrottled(2);\n    jest.advanceTimersByTime(threshold - 10);\n    expect(fn.mock.calls).toEqual([[1], [2]]);\n  });\n\n  test('should call not more than once per threshold and preserve correct call order', () => {\n    fnThrottled(1);\n    // call function immediately after the first call\n    expect(fn.mock.calls).toEqual([[1]]);\n\n    fnThrottled(2);\n    fnThrottled(3);\n    jest.advanceTimersByTime(threshold - 10); // 40ms\n    // throttle following calls until the threshold is reached\n    expect(fn.mock.calls).toEqual([[1]]);\n\n    fnThrottled(4);\n    jest.advanceTimersByTime(10); // 50ms\n    // call function with last arguments after the threshold is reached\n    expect(fn.mock.calls).toEqual([[1], [4]]);\n\n    jest.advanceTimersByTime(10); // 60ms\n    fnThrottled(5);\n    // don't call function immediately and wait until threshold reached\n    expect(fn.mock.calls).toEqual([[1], [4]]);\n\n    jest.advanceTimersByTime(threshold - 10); // 100ms\n    expect(fn.mock.calls).toEqual([[1], [4], [5]]);\n  });\n\n  it('should cancel throttled call', function () {\n    fnThrottled(1);\n    fnThrottled(2);\n    fnThrottled(3);\n    fnThrottled.cancel();\n    jest.advanceTimersByTime(threshold);\n\n    expect(fn).toHaveBeenCalledTimes(1);\n    expect(fn).toHaveBeenCalledWith(1);\n  });\n});\n\ndescribe('debounce', () => {\n  const delay = 50;\n  let fn: Mock<AnyFunction>;\n  let fnDebounced: ReturnType<typeof debounce>;\n\n  beforeEach(() => {\n    jest.useFakeTimers();\n    jest.setSystemTime(100);\n    fn = jest.fn();\n    fnDebounced = debounce(fn, delay);\n  });\n\n  test('should debounce function call', () => {\n    fnDebounced(1);\n    expect(fn.mock.calls).toEqual([]);\n\n    jest.advanceTimersByTime(10); // 10ms\n    fnDebounced(2);\n\n    jest.advanceTimersByTime(delay - 10); // 50ms\n    expect(fn.mock.calls).toEqual([]);\n\n    jest.advanceTimersByTime(10); // 60ms\n    expect(fn.mock.calls).toEqual([[2]]);\n  });\n\n  it('should cancel debounced call', function () {\n    fnDebounced(1);\n    fnDebounced(2);\n    fnDebounced(3);\n    fnDebounced.cancel();\n    jest.advanceTimersByTime(delay);\n\n    expect(fn).not.toHaveBeenCalled();\n  });\n});\n\ndescribe('once', () => {\n  test('should be called once', () => {\n    const fn = jest.fn();\n    const fnOnce = once(fn);\n\n    fnOnce();\n    fnOnce();\n    fnOnce();\n\n    expect(fn).toBeCalledTimes(1);\n  });\n});\n"],"mappings":";;AAAA;AACA;AAAwD,IAGjDA,IAAI,GAAGC,aAAI,CAACD,IAAI;AAEvB,IAAAE,iBAAQ,EAAC,UAAU,EAAE,YAAM;EACzB,IAAMC,SAAS,GAAG,EAAE;EACpB,IAAIC,EAAqB;EACzB,IAAIC,WAAwC;EAE5C,IAAAC,mBAAU,EAAC,YAAM;IACfL,aAAI,CAACM,aAAa,EAAE;IACpBN,aAAI,CAACO,aAAa,CAAC,GAAG,CAAC;IACvBJ,EAAE,GAAGH,aAAI,CAACG,EAAE,EAAE;IACdC,WAAW,GAAG,IAAAI,mBAAQ,EAACL,EAAE,EAAED,SAAS,CAAC;EACvC,CAAC,CAAC;EAEF,IAAAO,aAAI,EAAC,kEAAkE,EAAE,YAAM;IAC7EL,WAAW,CAAC,CAAC,CAAC;IACd,IAAAM,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAEpCb,aAAI,CAACc,mBAAmB,CAACZ,SAAS,CAAC;IACnCE,WAAW,CAAC,CAAC,CAAC;IACd,IAAAM,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3C,CAAC,CAAC;EAEF,IAAAJ,aAAI,EAAC,kDAAkD,EAAE,YAAM;IAC7DL,WAAW,CAAC,CAAC,CAAC;IACd,IAAAM,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACpCb,aAAI,CAACc,mBAAmB,CAAC,EAAE,CAAC;IAE5BV,WAAW,CAAC,CAAC,CAAC;IACdJ,aAAI,CAACc,mBAAmB,CAACZ,SAAS,GAAG,EAAE,CAAC;IACxC,IAAAQ,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3C,CAAC,CAAC;EAEF,IAAAJ,aAAI,EAAC,8EAA8E,EAAE,YAAM;IACzFL,WAAW,CAAC,CAAC,CAAC;IACd;IACA,IAAAM,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAEpCT,WAAW,CAAC,CAAC,CAAC;IACdA,WAAW,CAAC,CAAC,CAAC;IACdJ,aAAI,CAACc,mBAAmB,CAACZ,SAAS,GAAG,EAAE,CAAC,CAAC,CAAC;IAC1C;IACA,IAAAQ,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAEpCT,WAAW,CAAC,CAAC,CAAC;IACdJ,aAAI,CAACc,mBAAmB,CAAC,EAAE,CAAC,CAAC,CAAC;IAC9B;IACA,IAAAJ,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAEzCb,aAAI,CAACc,mBAAmB,CAAC,EAAE,CAAC,CAAC,CAAC;IAC9BV,WAAW,CAAC,CAAC,CAAC;IACd;IACA,IAAAM,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAEzCb,aAAI,CAACc,mBAAmB,CAACZ,SAAS,GAAG,EAAE,CAAC,CAAC,CAAC;IAC1C,IAAAQ,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAChD,CAAC,CAAC;EAEF,IAAAE,WAAE,EAAC,8BAA8B,EAAE,YAAY;IAC7CX,WAAW,CAAC,CAAC,CAAC;IACdA,WAAW,CAAC,CAAC,CAAC;IACdA,WAAW,CAAC,CAAC,CAAC;IACdA,WAAW,CAACY,MAAM,EAAE;IACpBhB,aAAI,CAACc,mBAAmB,CAACZ,SAAS,CAAC;IAEnC,IAAAQ,eAAM,EAACP,EAAE,CAAC,CAACc,qBAAqB,CAAC,CAAC,CAAC;IACnC,IAAAP,eAAM,EAACP,EAAE,CAAC,CAACe,oBAAoB,CAAC,CAAC,CAAC;EACpC,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF,IAAAjB,iBAAQ,EAAC,UAAU,EAAE,YAAM;EACzB,IAAMkB,KAAK,GAAG,EAAE;EAChB,IAAIhB,EAAqB;EACzB,IAAIiB,WAAwC;EAE5C,IAAAf,mBAAU,EAAC,YAAM;IACfL,aAAI,CAACM,aAAa,EAAE;IACpBN,aAAI,CAACO,aAAa,CAAC,GAAG,CAAC;IACvBJ,EAAE,GAAGH,aAAI,CAACG,EAAE,EAAE;IACdiB,WAAW,GAAG,IAAAC,mBAAQ,EAAClB,EAAE,EAAEgB,KAAK,CAAC;EACnC,CAAC,CAAC;EAEF,IAAAV,aAAI,EAAC,+BAA+B,EAAE,YAAM;IAC1CW,WAAW,CAAC,CAAC,CAAC;IACd,IAAAV,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,EAAE,CAAC;IAEjCb,aAAI,CAACc,mBAAmB,CAAC,EAAE,CAAC,CAAC,CAAC;IAC9BM,WAAW,CAAC,CAAC,CAAC;IAEdpB,aAAI,CAACc,mBAAmB,CAACK,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC;IACtC,IAAAT,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,EAAE,CAAC;IAEjCb,aAAI,CAACc,mBAAmB,CAAC,EAAE,CAAC,CAAC,CAAC;IAC9B,IAAAJ,eAAM,EAACP,EAAE,CAACQ,IAAI,CAACC,KAAK,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACtC,CAAC,CAAC;EAEF,IAAAE,WAAE,EAAC,8BAA8B,EAAE,YAAY;IAC7CK,WAAW,CAAC,CAAC,CAAC;IACdA,WAAW,CAAC,CAAC,CAAC;IACdA,WAAW,CAAC,CAAC,CAAC;IACdA,WAAW,CAACJ,MAAM,EAAE;IACpBhB,aAAI,CAACc,mBAAmB,CAACK,KAAK,CAAC;IAE/B,IAAAT,eAAM,EAACP,EAAE,CAAC,CAACmB,GAAG,CAACC,gBAAgB,EAAE;EACnC,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF,IAAAtB,iBAAQ,EAAC,MAAM,EAAE,YAAM;EACrB,IAAAQ,aAAI,EAAC,uBAAuB,EAAE,YAAM;IAClC,IAAMN,EAAE,GAAGH,aAAI,CAACG,EAAE,EAAE;IACpB,IAAMqB,MAAM,GAAG,IAAAC,eAAI,EAACtB,EAAE,CAAC;IAEvBqB,MAAM,EAAE;IACRA,MAAM,EAAE;IACRA,MAAM,EAAE;IAER,IAAAd,eAAM,EAACP,EAAE,CAAC,CAACuB,eAAe,CAAC,CAAC,CAAC;EAC/B,CAAC,CAAC;AACJ,CAAC,CAAC"}